--- net/minecraft/src/RenderBlocks.java
+++ net/minecraft/src/RenderBlocks.java
@@ -24,6 +24,7 @@
 	private float aoLightValueXPos;
 	private float aoLightValueYPos;
 	private float aoLightValueZPos;
+
 	private float field_22377_m;
 	private float field_22376_n;
 	private float field_22375_o;
@@ -44,7 +45,32 @@
 	private float field_22356_D;
 	private float field_22354_E;
 	private float field_22353_F;
+
+	private int field_35936_P;
+	private int field_35935_Q;
+	private int field_35938_R;
+	private int field_35937_S;
+	private int field_35932_T;
+	private int field_35931_U;
+	private int field_35934_V;
+	private int field_35933_W;
+	private int field_35940_X;
+	private int field_35939_Y;
+	private int field_35941_Z;
+	private int field_35951_aa;
+	private int field_35952_ab;
+	private int field_35949_ac;
+	private int field_35950_ad;
+	private int field_35955_ae;
+	private int field_35956_af;
+	private int field_35953_ag;
+	private int field_35954_ah;
+	private int field_35945_ai;
 	private int field_22352_G = 1;
+	private int field_35943_ak;
+	private int field_35944_al;
+	private int field_35947_am;
+	private int field_35948_an;
 	private float colorRedTopLeft;
 	private float colorRedBottomLeft;
 	private float colorRedBottomRight;
@@ -104,8 +130,9 @@
 		float var10 = 1.0F;
 		float var11 = 0.8F;
 		float var12 = 0.6F;
-		float var25 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
-		var5.setColorOpaque_F(var9 * var25, var9 * var25, var9 * var25);
+		int var25 = var1.func_35275_c(this.blockAccess, var2, var3, var4);
+		var5.func_35835_b(var25);
+		var5.setColorOpaque_F(var9, var9, var9);
 		int var26 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 0);
 		int var27 = (var26 & 15) << 4;
 		int var28 = var26 & 240;
@@ -122,8 +149,8 @@
 		var5.addVertexWithUV(var37, var41, var43, var29, var33);
 		var5.addVertexWithUV(var39, var41, var43, var31, var33);
 		var5.addVertexWithUV(var39, var41, var45, var31, var35);
-		float var64 = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4);
-		var5.setColorOpaque_F(var10 * var64, var10 * var64, var10 * var64);
+		var5.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4));
+		var5.setColorOpaque_F(var10, var10, var10);
 		var27 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 1);
 		var28 = (var27 & 15) << 4;
 		int var67 = var27 & 240;
@@ -190,45 +217,29 @@
 
 		float var66;
 		if(var26 != 2 && (this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3, var4 - 1, 2))) {
-			var66 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 - 1);
-			if(var1.minZ > 0.0D) {
-				var66 = var25;
-			}
-
-			var5.setColorOpaque_F(var11 * var66, var11 * var66, var11 * var66);
+			var5.func_35835_b(var1.minZ > 0.0D ? var25 : var1.func_35275_c(this.blockAccess, var2, var3, var4 - 1));
+			var5.setColorOpaque_F(var11, var11, var11);
 			this.flipTexture = var65 == 2;
 			this.renderEastFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 2));
 		}
 
 		if(var26 != 3 && (this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3, var4 + 1, 3))) {
-			var66 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 + 1);
-			if(var1.maxZ < 1.0D) {
-				var66 = var25;
-			}
-
-			var5.setColorOpaque_F(var11 * var66, var11 * var66, var11 * var66);
+			var5.func_35835_b(var1.maxZ < 1.0D ? var25 : var1.func_35275_c(this.blockAccess, var2, var3, var4 + 1));
+			var5.setColorOpaque_F(var11, var11, var11);
 			this.flipTexture = var65 == 3;
 			this.renderWestFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 3));
 		}
 
 		if(var26 != 4 && (this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2 - 1, var3, var4, 4))) {
-			var66 = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4);
-			if(var1.minX > 0.0D) {
-				var66 = var25;
-			}
-
-			var5.setColorOpaque_F(var12 * var66, var12 * var66, var12 * var66);
+			var5.func_35835_b(var1.minZ > 0.0D ? var25 : var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4));
+			var5.setColorOpaque_F(var12, var12, var12);
 			this.flipTexture = var65 == 4;
 			this.renderNorthFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 4));
 		}
 
 		if(var26 != 5 && (this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2 + 1, var3, var4, 5))) {
-			var66 = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4);
-			if(var1.maxX < 1.0D) {
-				var66 = var25;
-			}
-
-			var5.setColorOpaque_F(var12 * var66, var12 * var66, var12 * var66);
+			var5.func_35835_b(var1.maxZ < 1.0D ? var25 : var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4));
+			var5.setColorOpaque_F(var12, var12, var12);
 			this.flipTexture = var65 == 5;
 			this.renderSouthFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 5));
 		}
@@ -240,12 +251,8 @@
 	public boolean renderBlockTorch(Block var1, int var2, int var3, int var4) {
 		int var5 = this.blockAccess.getBlockMetadata(var2, var3, var4);
 		Tessellator var6 = Tessellator.instance;
-		float var7 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
-		if(Block.lightValue[var1.blockID] > 0) {
-			var7 = 1.0F;
-		}
-
-		var6.setColorOpaque_F(var7, var7, var7);
+		var6.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3, var4));
+		var6.setColorOpaque_F(1.0F, 1.0F, 1.0F);
 		double var8 = (double)0.4F;
 		double var10 = 0.5D - var8;
 		double var12 = (double)0.2F;
@@ -638,7 +645,8 @@
 			this.overrideBlockTexture = -1;
 		}
 
-		float var13 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
+		var8.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3, var4));
+		float var13 = 1.0F;
 		if(Block.lightValue[var1.blockID] > 0) {
 			var13 = 1.0F;
 		}
@@ -776,8 +784,8 @@
 			var6 = this.overrideBlockTexture;
 		}
 
-		float var7 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
-		var5.setColorOpaque_F(var7, var7, var7);
+		var5.setColorOpaque_F(1.0F, 1.0F, 1.0F);
+		var5.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3, var4));
 		int var8 = (var6 & 15) << 4;
 		int var9 = var6 & 240;
 		double var10 = (double)((float)var8 / 256.0F);
@@ -965,7 +973,8 @@
 			var7 = this.overrideBlockTexture;
 		}
 
-		float var8 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
+		var5.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3, var4));
+		float var8 = 1.0F;
 		float var9 = (float)var6 / 15.0F;
 		float var10 = var9 * 0.6F + 0.4F;
 		if(var6 == 0) {
@@ -1170,8 +1179,8 @@
 			var6 &= 7;
 		}
 
-		float var8 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
-		var5.setColorOpaque_F(var8, var8, var8);
+		var5.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3, var4));
+		var5.setColorOpaque_F(1.0F, 1.0F, 1.0F);
 		int var9 = (var7 & 15) << 4;
 		int var10 = var7 & 240;
 		double var11 = (double)((float)var9 / 256.0F);
@@ -1250,7 +1259,8 @@
 			var6 = this.overrideBlockTexture;
 		}
 
-		float var7 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
+		var5.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3, var4));
+		float var7 = 1.0F;
 		var5.setColorOpaque_F(var7, var7, var7);
 		int var8 = (var6 & 15) << 4;
 		int var9 = var6 & 240;
@@ -1294,7 +1304,8 @@
 
 	public boolean renderBlockReed(Block var1, int var2, int var3, int var4) {
 		Tessellator var5 = Tessellator.instance;
-		float var6 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
+		var5.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3, var4));
+		float var6 = 1.0F;
 		int var7 = var1.colorMultiplier(this.blockAccess, var2, var3, var4);
 		float var8 = (float)(var7 >> 16 & 255) / 255.0F;
 		float var9 = (float)(var7 >> 8 & 255) / 255.0F;
@@ -1326,8 +1337,8 @@
 
 	public boolean renderBlockCrops(Block var1, int var2, int var3, int var4) {
 		Tessellator var5 = Tessellator.instance;
-		float var6 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
-		var5.setColorOpaque_F(var6, var6, var6);
+		var5.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3, var4));
+		var5.setColorOpaque_F(1.0F, 1.0F, 1.0F);
 		this.func_1245_b(var1, this.blockAccess.getBlockMetadata(var2, var3, var4), (double)var2, (double)((float)var3 - 1.0F / 16.0F), (double)var4);
 		return true;
 	}
@@ -1520,7 +1531,8 @@
 
 				var36 = MathHelper.sin(var29) * 8.0F / 256.0F;
 				var37 = MathHelper.cos(var29) * 8.0F / 256.0F;
-				var38 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
+				var5.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3, var4));
+				var38 = 1.0F;
 				var5.setColorOpaque_F(var15 * var38 * var7, var15 * var38 * var8, var15 * var38 * var9);
 				var5.addVertexWithUV((double)(var2 + 0), (double)((float)var3 + var24), (double)(var4 + 0), var32 - (double)var37 - (double)var36, var34 - (double)var37 + (double)var36);
 				var5.addVertexWithUV((double)(var2 + 0), (double)((float)var3 + var25), (double)(var4 + 1), var32 - (double)var37 + (double)var36, var34 + (double)var37 + (double)var36);
@@ -1529,7 +1541,8 @@
 			}
 
 			if(this.renderAllFaces || var11) {
-				float var52 = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4);
+				var5.func_35835_b(var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4));
+				float var52 = 1.0F;
 				var5.setColorOpaque_F(var14 * var52, var14 * var52, var14 * var52);
 				this.renderBottomFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTextureFromSide(0));
 				var13 = true;
@@ -1597,7 +1610,8 @@
 					double var45 = (double)(((float)var55 + (1.0F - var35) * 16.0F) / 256.0F);
 					double var47 = (double)(((float)var55 + (1.0F - var36) * 16.0F) / 256.0F);
 					double var49 = ((double)(var55 + 16) - 0.01D) / 256.0D;
-					float var51 = var1.getBlockBrightness(this.blockAccess, var53, var3, var31);
+					var5.func_35835_b(var1.func_35275_c(this.blockAccess, var53, var3, var31));
+					float var51 = 1.0F;
 					if(var28 < 2) {
 						var51 *= var16;
 					} else {
@@ -1657,43 +1671,44 @@
 		float var9 = 0.6F;
 		Tessellator var10 = Tessellator.instance;
 		var10.startDrawingQuads();
-		float var11 = var1.getBlockBrightness(var2, var3, var4, var5);
-		float var12 = var1.getBlockBrightness(var2, var3, var4 - 1, var5);
+		var10.func_35835_b(var1.func_35275_c(var2, var3, var4, var5));
+		float var11 = 1.0F;
+		float var12 = 1.0F;
 		if(var12 < var11) {
 			var12 = var11;
 		}
 
 		var10.setColorOpaque_F(var6 * var12, var6 * var12, var6 * var12);
 		this.renderBottomFace(var1, -0.5D, -0.5D, -0.5D, var1.getBlockTextureFromSide(0));
-		var12 = var1.getBlockBrightness(var2, var3, var4 + 1, var5);
+		var12 = 1.0F;
 		if(var12 < var11) {
 			var12 = var11;
 		}
 
 		var10.setColorOpaque_F(var7 * var12, var7 * var12, var7 * var12);
 		this.renderTopFace(var1, -0.5D, -0.5D, -0.5D, var1.getBlockTextureFromSide(1));
-		var12 = var1.getBlockBrightness(var2, var3, var4, var5 - 1);
+		var12 = 1.0F;
 		if(var12 < var11) {
 			var12 = var11;
 		}
 
 		var10.setColorOpaque_F(var8 * var12, var8 * var12, var8 * var12);
 		this.renderEastFace(var1, -0.5D, -0.5D, -0.5D, var1.getBlockTextureFromSide(2));
-		var12 = var1.getBlockBrightness(var2, var3, var4, var5 + 1);
+		var12 = 1.0F;
 		if(var12 < var11) {
 			var12 = var11;
 		}
 
 		var10.setColorOpaque_F(var8 * var12, var8 * var12, var8 * var12);
 		this.renderWestFace(var1, -0.5D, -0.5D, -0.5D, var1.getBlockTextureFromSide(3));
-		var12 = var1.getBlockBrightness(var2, var3 - 1, var4, var5);
+		var12 = 1.0F;
 		if(var12 < var11) {
 			var12 = var11;
 		}
 
 		var10.setColorOpaque_F(var9 * var12, var9 * var12, var9 * var12);
 		this.renderNorthFace(var1, -0.5D, -0.5D, -0.5D, var1.getBlockTextureFromSide(4));
-		var12 = var1.getBlockBrightness(var2, var3 + 1, var4, var5);
+		var12 = 1.0F;
 		if(var12 < var11) {
 			var12 = var11;
 		}
@@ -1733,13 +1748,21 @@
 		boolean var16 = true;
 		boolean var17 = true;
 		boolean var18 = true;
-		this.lightValueOwn = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
-		this.aoLightValueXNeg = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4);
-		this.aoLightValueYNeg = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4);
-		this.aoLightValueZNeg = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 - 1);
-		this.aoLightValueXPos = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4);
-		this.aoLightValueYPos = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4);
-		this.aoLightValueZPos = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 + 1);
+		this.lightValueOwn = var1.func_35276_e(this.blockAccess, var2, var3, var4);
+		this.aoLightValueXNeg = var1.func_35276_e(this.blockAccess, var2 - 1, var3, var4);
+		this.aoLightValueYNeg = var1.func_35276_e(this.blockAccess, var2, var3 - 1, var4);
+		this.aoLightValueZNeg = var1.func_35276_e(this.blockAccess, var2, var3, var4 - 1);
+		this.aoLightValueXPos = var1.func_35276_e(this.blockAccess, var2 + 1, var3, var4);
+		this.aoLightValueYPos = var1.func_35276_e(this.blockAccess, var2, var3 + 1, var4);
+		this.aoLightValueZPos = var1.func_35276_e(this.blockAccess, var2, var3, var4 + 1);
+		int var19 = var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4);
+		int var20 = var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4);
+		int var21 = var1.func_35275_c(this.blockAccess, var2, var3, var4 - 1);
+		int var22 = var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4);
+		int var23 = var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4);
+		int var24 = var1.func_35275_c(this.blockAccess, var2, var3, var4 + 1);
+		Tessellator var25 = Tessellator.instance;
+		var25.func_35835_b(983055);
 		this.field_22338_U = Block.canBlockGrass[this.blockAccess.getBlockId(var2 + 1, var3 + 1, var4)];
 		this.field_22359_ac = Block.canBlockGrass[this.blockAccess.getBlockId(var2 + 1, var3 - 1, var4)];
 		this.field_22334_Y = Block.canBlockGrass[this.blockAccess.getBlockId(var2 + 1, var3, var4 + 1)];
@@ -1774,34 +1797,47 @@
 				var11 = var12;
 				var10 = var12;
 				var9 = var12;
+				this.field_35943_ak = this.field_35944_al = this.field_35947_am = this.field_35948_an = this.field_35935_Q;
 			} else {
 				--var3;
-				this.field_22376_n = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4);
-				this.field_22374_p = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 - 1);
-				this.field_22373_q = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 + 1);
-				this.field_22371_s = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4);
+				this.field_35935_Q = var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4);
+				this.field_35937_S = var1.func_35275_c(this.blockAccess, var2, var3, var4 - 1);
+				this.field_35932_T = var1.func_35275_c(this.blockAccess, var2, var3, var4 + 1);
+				this.field_35934_V = var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4);
+				this.field_22376_n = var1.func_35276_e(this.blockAccess, var2 - 1, var3, var4);
+				this.field_22374_p = var1.func_35276_e(this.blockAccess, var2, var3, var4 - 1);
+				this.field_22373_q = var1.func_35276_e(this.blockAccess, var2, var3, var4 + 1);
+				this.field_22371_s = var1.func_35276_e(this.blockAccess, var2 + 1, var3, var4);
 				if(!this.field_22361_ab && !this.field_22357_ad) {
 					this.field_22377_m = this.field_22376_n;
+					this.field_35936_P = this.field_35935_Q;
 				} else {
-					this.field_22377_m = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4 - 1);
+					this.field_22377_m = var1.func_35276_e(this.blockAccess, var2 - 1, var3, var4 - 1);
+					this.field_35936_P = var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4 - 1);
 				}
 
 				if(!this.field_22355_ae && !this.field_22357_ad) {
 					this.field_22375_o = this.field_22376_n;
+					this.field_35938_R = this.field_35935_Q;
 				} else {
-					this.field_22375_o = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4 + 1);
+					this.field_22375_o = var1.func_35276_e(this.blockAccess, var2 - 1, var3, var4 + 1);
+					this.field_35938_R = var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4 + 1);
 				}
 
 				if(!this.field_22361_ab && !this.field_22359_ac) {
 					this.field_22372_r = this.field_22371_s;
+					this.field_35931_U = this.field_35934_V;
 				} else {
-					this.field_22372_r = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4 - 1);
+					this.field_22372_r = var1.func_35276_e(this.blockAccess, var2 + 1, var3, var4 - 1);
+					this.field_35931_U = var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4 - 1);
 				}
 
 				if(!this.field_22355_ae && !this.field_22359_ac) {
 					this.field_22370_t = this.field_22371_s;
+					this.field_35933_W = this.field_35934_V;
 				} else {
-					this.field_22370_t = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4 + 1);
+					this.field_22370_t = var1.func_35276_e(this.blockAccess, var2 + 1, var3, var4 + 1);
+					this.field_35933_W = var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4 + 1);
 				}
 
 				++var3;
@@ -1809,6 +1845,10 @@
 				var12 = (this.field_22373_q + this.aoLightValueYNeg + this.field_22370_t + this.field_22371_s) / 4.0F;
 				var11 = (this.aoLightValueYNeg + this.field_22374_p + this.field_22371_s + this.field_22372_r) / 4.0F;
 				var10 = (this.field_22376_n + this.field_22377_m + this.aoLightValueYNeg + this.field_22374_p) / 4.0F;
+				this.field_35943_ak = this.func_35924_c(this.field_35938_R, this.field_35935_Q, this.field_35932_T, var20);
+				this.field_35948_an = this.func_35924_c(this.field_35932_T, this.field_35933_W, this.field_35934_V, var20);
+				this.field_35947_am = this.func_35924_c(this.field_35937_S, this.field_35934_V, this.field_35931_U, var20);
+				this.field_35944_al = this.func_35924_c(this.field_35935_Q, this.field_35936_P, this.field_35937_S, var20);
 			}
 
 			this.colorRedTopLeft = this.colorRedBottomLeft = this.colorRedBottomRight = this.colorRedTopRight = (var13 ? var5 : 1.0F) * 0.5F;
@@ -1836,34 +1876,47 @@
 				var11 = var12;
 				var10 = var12;
 				var9 = var12;
+				this.field_35943_ak = this.field_35944_al = this.field_35947_am = this.field_35948_an = var23;
 			} else {
 				++var3;
-				this.field_22368_v = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4);
-				this.field_22364_z = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4);
-				this.field_22366_x = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 - 1);
-				this.field_22362_A = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 + 1);
+				this.field_35939_Y = var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4);
+				this.field_35949_ac = var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4);
+				this.field_35951_aa = var1.func_35275_c(this.blockAccess, var2, var3, var4 - 1);
+				this.field_35950_ad = var1.func_35275_c(this.blockAccess, var2, var3, var4 + 1);
+				this.field_22368_v = var1.func_35276_e(this.blockAccess, var2 - 1, var3, var4);
+				this.field_22364_z = var1.func_35276_e(this.blockAccess, var2 + 1, var3, var4);
+				this.field_22366_x = var1.func_35276_e(this.blockAccess, var2, var3, var4 - 1);
+				this.field_22362_A = var1.func_35276_e(this.blockAccess, var2, var3, var4 + 1);
 				if(!this.field_22339_T && !this.field_22337_V) {
 					this.field_22369_u = this.field_22368_v;
+					this.field_35940_X = this.field_35939_Y;
 				} else {
-					this.field_22369_u = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4 - 1);
+					this.field_22369_u = var1.func_35276_e(this.blockAccess, var2 - 1, var3, var4 - 1);
+					this.field_35940_X = var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4 - 1);
 				}
 
 				if(!this.field_22339_T && !this.field_22338_U) {
 					this.field_22365_y = this.field_22364_z;
+					this.field_35952_ab = this.field_35949_ac;
 				} else {
-					this.field_22365_y = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4 - 1);
+					this.field_22365_y = var1.func_35276_e(this.blockAccess, var2 + 1, var3, var4 - 1);
+					this.field_35952_ab = var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4 - 1);
 				}
 
 				if(!this.field_22336_W && !this.field_22337_V) {
 					this.field_22367_w = this.field_22368_v;
+					this.field_35941_Z = this.field_35939_Y;
 				} else {
-					this.field_22367_w = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4 + 1);
+					this.field_22367_w = var1.func_35276_e(this.blockAccess, var2 - 1, var3, var4 + 1);
+					this.field_35941_Z = var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4 + 1);
 				}
 
 				if(!this.field_22336_W && !this.field_22338_U) {
 					this.field_22360_B = this.field_22364_z;
+					this.field_35955_ae = this.field_35949_ac;
 				} else {
-					this.field_22360_B = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4 + 1);
+					this.field_22360_B = var1.func_35276_e(this.blockAccess, var2 + 1, var3, var4 + 1);
+					this.field_35955_ae = var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4 + 1);
 				}
 
 				--var3;
@@ -1871,6 +1924,10 @@
 				var9 = (this.field_22362_A + this.aoLightValueYPos + this.field_22360_B + this.field_22364_z) / 4.0F;
 				var10 = (this.aoLightValueYPos + this.field_22366_x + this.field_22364_z + this.field_22365_y) / 4.0F;
 				var11 = (this.field_22368_v + this.field_22369_u + this.aoLightValueYPos + this.field_22366_x) / 4.0F;
+				this.field_35948_an = this.func_35924_c(this.field_35941_Z, this.field_35939_Y, this.field_35950_ad, var23);
+				this.field_35943_ak = this.func_35924_c(this.field_35950_ad, this.field_35955_ae, this.field_35949_ac, var23);
+				this.field_35944_al = this.func_35924_c(this.field_35951_aa, this.field_35949_ac, this.field_35952_ab, var23);
+				this.field_35947_am = this.func_35924_c(this.field_35939_Y, this.field_35940_X, this.field_35951_aa, var23);
 			}
 
 			this.colorRedTopLeft = this.colorRedBottomLeft = this.colorRedBottomRight = this.colorRedTopRight = var14 ? var5 : 1.0F;
@@ -1892,41 +1949,54 @@
 			var8 = true;
 		}
 
-		int var19;
+		int var26;
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3, var4 - 1, 2)) {
 			if(this.field_22352_G <= 0) {
 				var12 = this.aoLightValueZNeg;
 				var11 = var12;
 				var10 = var12;
 				var9 = var12;
+				this.field_35943_ak = this.field_35944_al = this.field_35947_am = this.field_35948_an = var21;
 			} else {
 				--var4;
-				this.field_22358_C = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4);
-				this.field_22374_p = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4);
-				this.field_22366_x = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4);
-				this.field_22356_D = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4);
+				this.field_22358_C = var1.func_35276_e(this.blockAccess, var2 - 1, var3, var4);
+				this.field_22374_p = var1.func_35276_e(this.blockAccess, var2, var3 - 1, var4);
+				this.field_22366_x = var1.func_35276_e(this.blockAccess, var2, var3 + 1, var4);
+				this.field_22356_D = var1.func_35276_e(this.blockAccess, var2 + 1, var3, var4);
+				this.field_35956_af = var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4);
+				this.field_35937_S = var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4);
+				this.field_35951_aa = var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4);
+				this.field_35953_ag = var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4);
 				if(!this.field_22335_X && !this.field_22361_ab) {
 					this.field_22377_m = this.field_22358_C;
+					this.field_35936_P = this.field_35956_af;
 				} else {
-					this.field_22377_m = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3 - 1, var4);
+					this.field_22377_m = var1.func_35276_e(this.blockAccess, var2 - 1, var3 - 1, var4);
+					this.field_35936_P = var1.func_35275_c(this.blockAccess, var2 - 1, var3 - 1, var4);
 				}
 
 				if(!this.field_22335_X && !this.field_22339_T) {
 					this.field_22369_u = this.field_22358_C;
+					this.field_35940_X = this.field_35956_af;
 				} else {
-					this.field_22369_u = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3 + 1, var4);
+					this.field_22369_u = var1.func_35276_e(this.blockAccess, var2 - 1, var3 + 1, var4);
+					this.field_35940_X = var1.func_35275_c(this.blockAccess, var2 - 1, var3 + 1, var4);
 				}
 
 				if(!this.field_22363_aa && !this.field_22361_ab) {
 					this.field_22372_r = this.field_22356_D;
+					this.field_35931_U = this.field_35953_ag;
 				} else {
-					this.field_22372_r = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3 - 1, var4);
+					this.field_22372_r = var1.func_35276_e(this.blockAccess, var2 + 1, var3 - 1, var4);
+					this.field_35931_U = var1.func_35275_c(this.blockAccess, var2 + 1, var3 - 1, var4);
 				}
 
 				if(!this.field_22363_aa && !this.field_22339_T) {
 					this.field_22365_y = this.field_22356_D;
+					this.field_35952_ab = this.field_35953_ag;
 				} else {
-					this.field_22365_y = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3 + 1, var4);
+					this.field_22365_y = var1.func_35276_e(this.blockAccess, var2 + 1, var3 + 1, var4);
+					this.field_35952_ab = var1.func_35275_c(this.blockAccess, var2 + 1, var3 + 1, var4);
 				}
 
 				++var4;
@@ -1934,6 +2004,10 @@
 				var10 = (this.aoLightValueZNeg + this.field_22366_x + this.field_22356_D + this.field_22365_y) / 4.0F;
 				var11 = (this.field_22374_p + this.aoLightValueZNeg + this.field_22372_r + this.field_22356_D) / 4.0F;
 				var12 = (this.field_22377_m + this.field_22358_C + this.field_22374_p + this.aoLightValueZNeg) / 4.0F;
+				this.field_35943_ak = this.func_35924_c(this.field_35956_af, this.field_35940_X, this.field_35951_aa, var21);
+				this.field_35944_al = this.func_35924_c(this.field_35951_aa, this.field_35953_ag, this.field_35952_ab, var21);
+				this.field_35947_am = this.func_35924_c(this.field_35937_S, this.field_35931_U, this.field_35953_ag, var21);
+				this.field_35948_an = this.func_35924_c(this.field_35936_P, this.field_35956_af, this.field_35937_S, var21);
 			}
 
 			this.colorRedTopLeft = this.colorRedBottomLeft = this.colorRedBottomRight = this.colorRedTopRight = (var15 ? var5 : 1.0F) * 0.8F;
@@ -1951,9 +2025,9 @@
 			this.colorRedTopRight *= var12;
 			this.colorGreenTopRight *= var12;
 			this.colorBlueTopRight *= var12;
-			var19 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 2);
-			this.renderEastFace(var1, (double)var2, (double)var3, (double)var4, var19);
-			if(fancyGrass && var19 == 3 && this.overrideBlockTexture < 0) {
+			var26 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 2);
+			this.renderEastFace(var1, (double)var2, (double)var3, (double)var4, var26);
+			if(fancyGrass && var26 == 3 && this.overrideBlockTexture < 0) {
 				this.colorRedTopLeft *= var5;
 				this.colorRedBottomLeft *= var5;
 				this.colorRedBottomRight *= var5;
@@ -1978,34 +2052,47 @@
 				var11 = var12;
 				var10 = var12;
 				var9 = var12;
+				this.field_35943_ak = this.field_35944_al = this.field_35947_am = this.field_35948_an = var24;
 			} else {
 				++var4;
-				this.field_22354_E = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4);
-				this.field_22353_F = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4);
-				this.field_22373_q = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4);
-				this.field_22362_A = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4);
+				this.field_22354_E = var1.func_35276_e(this.blockAccess, var2 - 1, var3, var4);
+				this.field_22353_F = var1.func_35276_e(this.blockAccess, var2 + 1, var3, var4);
+				this.field_22373_q = var1.func_35276_e(this.blockAccess, var2, var3 - 1, var4);
+				this.field_22362_A = var1.func_35276_e(this.blockAccess, var2, var3 + 1, var4);
+				this.field_35954_ah = var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4);
+				this.field_35945_ai = var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4);
+				this.field_35932_T = var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4);
+				this.field_35950_ad = var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4);
 				if(!this.field_22333_Z && !this.field_22355_ae) {
 					this.field_22375_o = this.field_22354_E;
+					this.field_35938_R = this.field_35954_ah;
 				} else {
-					this.field_22375_o = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3 - 1, var4);
+					this.field_22375_o = var1.func_35276_e(this.blockAccess, var2 - 1, var3 - 1, var4);
+					this.field_35938_R = var1.func_35275_c(this.blockAccess, var2 - 1, var3 - 1, var4);
 				}
 
 				if(!this.field_22333_Z && !this.field_22336_W) {
 					this.field_22367_w = this.field_22354_E;
+					this.field_35941_Z = this.field_35954_ah;
 				} else {
-					this.field_22367_w = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3 + 1, var4);
+					this.field_22367_w = var1.func_35276_e(this.blockAccess, var2 - 1, var3 + 1, var4);
+					this.field_35941_Z = var1.func_35275_c(this.blockAccess, var2 - 1, var3 + 1, var4);
 				}
 
 				if(!this.field_22334_Y && !this.field_22355_ae) {
 					this.field_22370_t = this.field_22353_F;
+					this.field_35933_W = this.field_35945_ai;
 				} else {
-					this.field_22370_t = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3 - 1, var4);
+					this.field_22370_t = var1.func_35276_e(this.blockAccess, var2 + 1, var3 - 1, var4);
+					this.field_35933_W = var1.func_35275_c(this.blockAccess, var2 + 1, var3 - 1, var4);
 				}
 
 				if(!this.field_22334_Y && !this.field_22336_W) {
 					this.field_22360_B = this.field_22353_F;
+					this.field_35955_ae = this.field_35945_ai;
 				} else {
-					this.field_22360_B = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3 + 1, var4);
+					this.field_22360_B = var1.func_35276_e(this.blockAccess, var2 + 1, var3 + 1, var4);
+					this.field_35955_ae = var1.func_35275_c(this.blockAccess, var2 + 1, var3 + 1, var4);
 				}
 
 				--var4;
@@ -2013,6 +2100,10 @@
 				var12 = (this.aoLightValueZPos + this.field_22362_A + this.field_22353_F + this.field_22360_B) / 4.0F;
 				var11 = (this.field_22373_q + this.aoLightValueZPos + this.field_22370_t + this.field_22353_F) / 4.0F;
 				var10 = (this.field_22375_o + this.field_22354_E + this.field_22373_q + this.aoLightValueZPos) / 4.0F;
+				this.field_35943_ak = this.func_35924_c(this.field_35954_ah, this.field_35941_Z, this.field_35950_ad, var24);
+				this.field_35948_an = this.func_35924_c(this.field_35950_ad, this.field_35945_ai, this.field_35955_ae, var24);
+				this.field_35947_am = this.func_35924_c(this.field_35932_T, this.field_35933_W, this.field_35945_ai, var24);
+				this.field_35944_al = this.func_35924_c(this.field_35938_R, this.field_35954_ah, this.field_35932_T, var24);
 			}
 
 			this.colorRedTopLeft = this.colorRedBottomLeft = this.colorRedBottomRight = this.colorRedTopRight = (var16 ? var5 : 1.0F) * 0.8F;
@@ -2030,9 +2121,9 @@
 			this.colorRedTopRight *= var12;
 			this.colorGreenTopRight *= var12;
 			this.colorBlueTopRight *= var12;
-			var19 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 3);
+			var26 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 3);
 			this.renderWestFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 3));
-			if(fancyGrass && var19 == 3 && this.overrideBlockTexture < 0) {
+			if(fancyGrass && var26 == 3 && this.overrideBlockTexture < 0) {
 				this.colorRedTopLeft *= var5;
 				this.colorRedBottomLeft *= var5;
 				this.colorRedBottomRight *= var5;
@@ -2057,34 +2148,47 @@
 				var11 = var12;
 				var10 = var12;
 				var9 = var12;
+				this.field_35943_ak = this.field_35944_al = this.field_35947_am = this.field_35948_an = var19;
 			} else {
 				--var2;
-				this.field_22376_n = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4);
-				this.field_22358_C = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 - 1);
-				this.field_22354_E = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 + 1);
-				this.field_22368_v = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4);
+				this.field_22376_n = var1.func_35276_e(this.blockAccess, var2, var3 - 1, var4);
+				this.field_22358_C = var1.func_35276_e(this.blockAccess, var2, var3, var4 - 1);
+				this.field_22354_E = var1.func_35276_e(this.blockAccess, var2, var3, var4 + 1);
+				this.field_22368_v = var1.func_35276_e(this.blockAccess, var2, var3 + 1, var4);
+				this.field_35935_Q = var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4);
+				this.field_35956_af = var1.func_35275_c(this.blockAccess, var2, var3, var4 - 1);
+				this.field_35954_ah = var1.func_35275_c(this.blockAccess, var2, var3, var4 + 1);
+				this.field_35939_Y = var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4);
 				if(!this.field_22335_X && !this.field_22357_ad) {
 					this.field_22377_m = this.field_22358_C;
+					this.field_35936_P = this.field_35956_af;
 				} else {
-					this.field_22377_m = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4 - 1);
+					this.field_22377_m = var1.func_35276_e(this.blockAccess, var2, var3 - 1, var4 - 1);
+					this.field_35936_P = var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4 - 1);
 				}
 
 				if(!this.field_22333_Z && !this.field_22357_ad) {
 					this.field_22375_o = this.field_22354_E;
+					this.field_35938_R = this.field_35954_ah;
 				} else {
-					this.field_22375_o = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4 + 1);
+					this.field_22375_o = var1.func_35276_e(this.blockAccess, var2, var3 - 1, var4 + 1);
+					this.field_35938_R = var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4 + 1);
 				}
 
 				if(!this.field_22335_X && !this.field_22337_V) {
 					this.field_22369_u = this.field_22358_C;
+					this.field_35940_X = this.field_35956_af;
 				} else {
-					this.field_22369_u = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4 - 1);
+					this.field_22369_u = var1.func_35276_e(this.blockAccess, var2, var3 + 1, var4 - 1);
+					this.field_35940_X = var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4 - 1);
 				}
 
 				if(!this.field_22333_Z && !this.field_22337_V) {
 					this.field_22367_w = this.field_22354_E;
+					this.field_35941_Z = this.field_35954_ah;
 				} else {
-					this.field_22367_w = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4 + 1);
+					this.field_22367_w = var1.func_35276_e(this.blockAccess, var2, var3 + 1, var4 + 1);
+					this.field_35941_Z = var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4 + 1);
 				}
 
 				++var2;
@@ -2092,6 +2196,10 @@
 				var9 = (this.aoLightValueXNeg + this.field_22354_E + this.field_22368_v + this.field_22367_w) / 4.0F;
 				var10 = (this.field_22358_C + this.aoLightValueXNeg + this.field_22369_u + this.field_22368_v) / 4.0F;
 				var11 = (this.field_22377_m + this.field_22376_n + this.field_22358_C + this.aoLightValueXNeg) / 4.0F;
+				this.field_35948_an = this.func_35924_c(this.field_35935_Q, this.field_35938_R, this.field_35954_ah, var19);
+				this.field_35943_ak = this.func_35924_c(this.field_35954_ah, this.field_35939_Y, this.field_35941_Z, var19);
+				this.field_35944_al = this.func_35924_c(this.field_35956_af, this.field_35940_X, this.field_35939_Y, var19);
+				this.field_35947_am = this.func_35924_c(this.field_35936_P, this.field_35935_Q, this.field_35956_af, var19);
 			}
 
 			this.colorRedTopLeft = this.colorRedBottomLeft = this.colorRedBottomRight = this.colorRedTopRight = (var17 ? var5 : 1.0F) * 0.6F;
@@ -2109,9 +2217,9 @@
 			this.colorRedTopRight *= var12;
 			this.colorGreenTopRight *= var12;
 			this.colorBlueTopRight *= var12;
-			var19 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 4);
-			this.renderNorthFace(var1, (double)var2, (double)var3, (double)var4, var19);
-			if(fancyGrass && var19 == 3 && this.overrideBlockTexture < 0) {
+			var26 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 4);
+			this.renderNorthFace(var1, (double)var2, (double)var3, (double)var4, var26);
+			if(fancyGrass && var26 == 3 && this.overrideBlockTexture < 0) {
 				this.colorRedTopLeft *= var5;
 				this.colorRedBottomLeft *= var5;
 				this.colorRedBottomRight *= var5;
@@ -2136,34 +2244,47 @@
 				var11 = var12;
 				var10 = var12;
 				var9 = var12;
+				this.field_35943_ak = this.field_35944_al = this.field_35947_am = this.field_35948_an = var22;
 			} else {
 				++var2;
-				this.field_22371_s = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4);
-				this.field_22356_D = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 - 1);
-				this.field_22353_F = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 + 1);
-				this.field_22364_z = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4);
+				this.field_22371_s = var1.func_35276_e(this.blockAccess, var2, var3 - 1, var4);
+				this.field_22356_D = var1.func_35276_e(this.blockAccess, var2, var3, var4 - 1);
+				this.field_22353_F = var1.func_35276_e(this.blockAccess, var2, var3, var4 + 1);
+				this.field_22364_z = var1.func_35276_e(this.blockAccess, var2, var3 + 1, var4);
+				this.field_35934_V = var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4);
+				this.field_35953_ag = var1.func_35275_c(this.blockAccess, var2, var3, var4 - 1);
+				this.field_35945_ai = var1.func_35275_c(this.blockAccess, var2, var3, var4 + 1);
+				this.field_35949_ac = var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4);
 				if(!this.field_22359_ac && !this.field_22363_aa) {
 					this.field_22372_r = this.field_22356_D;
+					this.field_35931_U = this.field_35953_ag;
 				} else {
-					this.field_22372_r = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4 - 1);
+					this.field_22372_r = var1.func_35276_e(this.blockAccess, var2, var3 - 1, var4 - 1);
+					this.field_35931_U = var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4 - 1);
 				}
 
 				if(!this.field_22359_ac && !this.field_22334_Y) {
 					this.field_22370_t = this.field_22353_F;
+					this.field_35933_W = this.field_35945_ai;
 				} else {
-					this.field_22370_t = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4 + 1);
+					this.field_22370_t = var1.func_35276_e(this.blockAccess, var2, var3 - 1, var4 + 1);
+					this.field_35933_W = var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4 + 1);
 				}
 
 				if(!this.field_22338_U && !this.field_22363_aa) {
 					this.field_22365_y = this.field_22356_D;
+					this.field_35952_ab = this.field_35953_ag;
 				} else {
-					this.field_22365_y = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4 - 1);
+					this.field_22365_y = var1.func_35276_e(this.blockAccess, var2, var3 + 1, var4 - 1);
+					this.field_35952_ab = var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4 - 1);
 				}
 
 				if(!this.field_22338_U && !this.field_22334_Y) {
 					this.field_22360_B = this.field_22353_F;
+					this.field_35955_ae = this.field_35945_ai;
 				} else {
-					this.field_22360_B = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4 + 1);
+					this.field_22360_B = var1.func_35276_e(this.blockAccess, var2, var3 + 1, var4 + 1);
+					this.field_35955_ae = var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4 + 1);
 				}
 
 				--var2;
@@ -2171,6 +2292,10 @@
 				var12 = (this.aoLightValueXPos + this.field_22353_F + this.field_22364_z + this.field_22360_B) / 4.0F;
 				var11 = (this.field_22356_D + this.aoLightValueXPos + this.field_22365_y + this.field_22364_z) / 4.0F;
 				var10 = (this.field_22372_r + this.field_22371_s + this.field_22356_D + this.aoLightValueXPos) / 4.0F;
+				this.field_35943_ak = this.func_35924_c(this.field_35934_V, this.field_35933_W, this.field_35945_ai, var22);
+				this.field_35948_an = this.func_35924_c(this.field_35945_ai, this.field_35949_ac, this.field_35955_ae, var22);
+				this.field_35947_am = this.func_35924_c(this.field_35953_ag, this.field_35952_ab, this.field_35949_ac, var22);
+				this.field_35944_al = this.func_35924_c(this.field_35931_U, this.field_35934_V, this.field_35953_ag, var22);
 			}
 
 			this.colorRedTopLeft = this.colorRedBottomLeft = this.colorRedBottomRight = this.colorRedTopRight = (var18 ? var5 : 1.0F) * 0.6F;
@@ -2188,9 +2313,9 @@
 			this.colorRedTopRight *= var12;
 			this.colorGreenTopRight *= var12;
 			this.colorBlueTopRight *= var12;
-			var19 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 5);
-			this.renderSouthFace(var1, (double)var2, (double)var3, (double)var4, var19);
-			if(fancyGrass && var19 == 3 && this.overrideBlockTexture < 0) {
+			var26 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 5);
+			this.renderSouthFace(var1, (double)var2, (double)var3, (double)var4, var26);
+			if(fancyGrass && var26 == 3 && this.overrideBlockTexture < 0) {
 				this.colorRedTopLeft *= var5;
 				this.colorRedBottomLeft *= var5;
 				this.colorRedBottomRight *= var5;
@@ -2213,6 +2338,22 @@
 		return var8;
 	}
 
+	private int func_35924_c(int var1, int var2, int var3, int var4) {
+		if(var1 == 0) {
+			var1 = var4;
+		}
+
+		if(var2 == 0) {
+			var2 = var4;
+		}
+
+		if(var3 == 0) {
+			var3 = var4;
+		}
+
+		return var1 + var2 + var3 + var4 >> 2 & 16711935;
+	}
+
 	public boolean renderStandardBlockWithColorMultiplier(Block var1, int var2, int var3, int var4, float var5, float var6, float var7) {
 		this.enableAO = false;
 		Tessellator var8 = Tessellator.instance;
@@ -2245,38 +2386,29 @@
 			var25 = var13 * var7;
 		}
 
-		float var26 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
-		float var27;
+		int var26 = var1.func_35275_c(this.blockAccess, var2, var3, var4);
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3 - 1, var4, 0)) {
-			var27 = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4);
-			var8.setColorOpaque_F(var17 * var27, var20 * var27, var23 * var27);
+			var8.func_35835_b(var1.minY > 0.0D ? var26 : var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4));
+			var8.setColorOpaque_F(var17, var20, var23);
 			this.renderBottomFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 0));
 			var9 = true;
 		}
 
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3 + 1, var4, 1)) {
-			var27 = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4);
-			if(var1.maxY != 1.0D && !var1.blockMaterial.getIsLiquid()) {
-				var27 = var26;
-			}
-
-			var8.setColorOpaque_F(var14 * var27, var15 * var27, var16 * var27);
+			var8.func_35835_b(var1.maxY < 1.0D ? var26 : var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4));
+			var8.setColorOpaque_F(var14, var15, var16);
 			this.renderTopFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 1));
 			var9 = true;
 		}
 
 		int var28;
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3, var4 - 1, 2)) {
-			var27 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 - 1);
-			if(var1.minZ > 0.0D) {
-				var27 = var26;
-			}
-
-			var8.setColorOpaque_F(var18 * var27, var21 * var27, var24 * var27);
+			var8.func_35835_b(var1.minZ > 0.0D ? var26 : var1.func_35275_c(this.blockAccess, var2, var3, var4 - 1));
+			var8.setColorOpaque_F(var18, var21, var24);
 			var28 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 2);
 			this.renderEastFace(var1, (double)var2, (double)var3, (double)var4, var28);
 			if(fancyGrass && var28 == 3 && this.overrideBlockTexture < 0) {
-				var8.setColorOpaque_F(var18 * var27 * var5, var21 * var27 * var6, var24 * var27 * var7);
+				var8.setColorOpaque_F(var18 * var5, var21 * var6, var24 * var7);
 				this.renderEastFace(var1, (double)var2, (double)var3, (double)var4, 38);
 			}
 
@@ -2284,16 +2416,12 @@
 		}
 
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3, var4 + 1, 3)) {
-			var27 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 + 1);
-			if(var1.maxZ < 1.0D) {
-				var27 = var26;
-			}
-
-			var8.setColorOpaque_F(var18 * var27, var21 * var27, var24 * var27);
+			var8.func_35835_b(var1.maxZ < 1.0D ? var26 : var1.func_35275_c(this.blockAccess, var2, var3, var4 + 1));
+			var8.setColorOpaque_F(var18, var21, var24);
 			var28 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 3);
 			this.renderWestFace(var1, (double)var2, (double)var3, (double)var4, var28);
 			if(fancyGrass && var28 == 3 && this.overrideBlockTexture < 0) {
-				var8.setColorOpaque_F(var18 * var27 * var5, var21 * var27 * var6, var24 * var27 * var7);
+				var8.setColorOpaque_F(var18 * var5, var21 * var6, var24 * var7);
 				this.renderWestFace(var1, (double)var2, (double)var3, (double)var4, 38);
 			}
 
@@ -2301,16 +2429,12 @@
 		}
 
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2 - 1, var3, var4, 4)) {
-			var27 = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4);
-			if(var1.minX > 0.0D) {
-				var27 = var26;
-			}
-
-			var8.setColorOpaque_F(var19 * var27, var22 * var27, var25 * var27);
+			var8.func_35835_b(var1.minX > 0.0D ? var26 : var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4));
+			var8.setColorOpaque_F(var19, var22, var25);
 			var28 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 4);
 			this.renderNorthFace(var1, (double)var2, (double)var3, (double)var4, var28);
 			if(fancyGrass && var28 == 3 && this.overrideBlockTexture < 0) {
-				var8.setColorOpaque_F(var19 * var27 * var5, var22 * var27 * var6, var25 * var27 * var7);
+				var8.setColorOpaque_F(var19 * var5, var22 * var6, var25 * var7);
 				this.renderNorthFace(var1, (double)var2, (double)var3, (double)var4, 38);
 			}
 
@@ -2318,16 +2442,12 @@
 		}
 
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2 + 1, var3, var4, 5)) {
-			var27 = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4);
-			if(var1.maxX < 1.0D) {
-				var27 = var26;
-			}
-
-			var8.setColorOpaque_F(var19 * var27, var22 * var27, var25 * var27);
+			var8.func_35835_b(var1.maxX < 1.0D ? var26 : var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4));
+			var8.setColorOpaque_F(var19, var22, var25);
 			var28 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 5);
 			this.renderSouthFace(var1, (double)var2, (double)var3, (double)var4, var28);
 			if(fancyGrass && var28 == 3 && this.overrideBlockTexture < 0) {
-				var8.setColorOpaque_F(var19 * var27 * var5, var22 * var27 * var6, var25 * var27 * var7);
+				var8.setColorOpaque_F(var19 * var5, var22 * var6, var25 * var7);
 				this.renderSouthFace(var1, (double)var2, (double)var3, (double)var4, 38);
 			}
 
@@ -2374,33 +2494,24 @@
 		float var24 = var12 * var7;
 		float var25 = var13 * var7;
 		float var26 = 1.0F / 16.0F;
-		float var27 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
-		float var28;
+		int var28 = var1.func_35275_c(this.blockAccess, var2, var3, var4);
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3 - 1, var4, 0)) {
-			var28 = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4);
-			var8.setColorOpaque_F(var14 * var28, var18 * var28, var22 * var28);
+			var8.func_35835_b(var1.minY > 0.0D ? var28 : var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4));
+			var8.setColorOpaque_F(var14, var18, var22);
 			this.renderBottomFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 0));
 			var9 = true;
 		}
 
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3 + 1, var4, 1)) {
-			var28 = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4);
-			if(var1.maxY != 1.0D && !var1.blockMaterial.getIsLiquid()) {
-				var28 = var27;
-			}
-
-			var8.setColorOpaque_F(var15 * var28, var19 * var28, var23 * var28);
+			var8.func_35835_b(var1.maxY < 1.0D ? var28 : var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4));
+			var8.setColorOpaque_F(var15, var19, var23);
 			this.renderTopFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 1));
 			var9 = true;
 		}
 
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3, var4 - 1, 2)) {
-			var28 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 - 1);
-			if(var1.minZ > 0.0D) {
-				var28 = var27;
-			}
-
-			var8.setColorOpaque_F(var16 * var28, var20 * var28, var24 * var28);
+			var8.func_35835_b(var1.minZ > 0.0D ? var28 : var1.func_35275_c(this.blockAccess, var2, var3, var4 - 1));
+			var8.setColorOpaque_F(var16, var20, var24);
 			var8.setTranslationF(0.0F, 0.0F, var26);
 			this.renderEastFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 2));
 			var8.setTranslationF(0.0F, 0.0F, -var26);
@@ -2408,12 +2519,8 @@
 		}
 
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2, var3, var4 + 1, 3)) {
-			var28 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 + 1);
-			if(var1.maxZ < 1.0D) {
-				var28 = var27;
-			}
-
-			var8.setColorOpaque_F(var16 * var28, var20 * var28, var24 * var28);
+			var8.func_35835_b(var1.maxZ < 1.0D ? var28 : var1.func_35275_c(this.blockAccess, var2, var3, var4 + 1));
+			var8.setColorOpaque_F(var16, var20, var24);
 			var8.setTranslationF(0.0F, 0.0F, -var26);
 			this.renderWestFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 3));
 			var8.setTranslationF(0.0F, 0.0F, var26);
@@ -2421,12 +2528,8 @@
 		}
 
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2 - 1, var3, var4, 4)) {
-			var28 = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4);
-			if(var1.minX > 0.0D) {
-				var28 = var27;
-			}
-
-			var8.setColorOpaque_F(var17 * var28, var21 * var28, var25 * var28);
+			var8.func_35835_b(var1.minX > 0.0D ? var28 : var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4));
+			var8.setColorOpaque_F(var17, var21, var25);
 			var8.setTranslationF(var26, 0.0F, 0.0F);
 			this.renderNorthFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 4));
 			var8.setTranslationF(-var26, 0.0F, 0.0F);
@@ -2434,12 +2537,8 @@
 		}
 
 		if(this.renderAllFaces || var1.shouldSideBeRendered(this.blockAccess, var2 + 1, var3, var4, 5)) {
-			var28 = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4);
-			if(var1.maxX < 1.0D) {
-				var28 = var27;
-			}
-
-			var8.setColorOpaque_F(var17 * var28, var21 * var28, var25 * var28);
+			var8.func_35835_b(var1.maxX < 1.0D ? var28 : var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4));
+			var8.setColorOpaque_F(var17, var21, var25);
 			var8.setTranslationF(-var26, 0.0F, 0.0F);
 			this.renderSouthFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 5));
 			var8.setTranslationF(var26, 0.0F, 0.0F);
@@ -2553,41 +2652,17 @@
 		float var9 = 1.0F;
 		float var10 = 0.8F;
 		float var11 = 0.6F;
-		float var12 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4);
-		float var13 = var1.getBlockBrightness(this.blockAccess, var2, var3 - 1, var4);
-		if(var6.minY > 0.0D) {
-			var13 = var12;
-		}
-
-		if(Block.lightValue[var1.blockID] > 0) {
-			var13 = 1.0F;
-		}
-
-		var5.setColorOpaque_F(var8 * var13, var8 * var13, var8 * var13);
+		int var12 = var1.func_35275_c(this.blockAccess, var2, var3, var4);
+		var5.func_35835_b(var1.minY > 0.0D ? var12 : var1.func_35275_c(this.blockAccess, var2, var3 - 1, var4));
+		var5.setColorOpaque_F(var8, var8, var8);
 		this.renderBottomFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 0));
 		var7 = true;
-		var13 = var1.getBlockBrightness(this.blockAccess, var2, var3 + 1, var4);
-		if(var6.maxY < 1.0D) {
-			var13 = var12;
-		}
-
-		if(Block.lightValue[var1.blockID] > 0) {
-			var13 = 1.0F;
-		}
-
-		var5.setColorOpaque_F(var9 * var13, var9 * var13, var9 * var13);
+		var5.func_35835_b(var1.maxY < 1.0D ? var12 : var1.func_35275_c(this.blockAccess, var2, var3 + 1, var4));
+		var5.setColorOpaque_F(var9, var9, var9);
 		this.renderTopFace(var1, (double)var2, (double)var3, (double)var4, var1.getBlockTexture(this.blockAccess, var2, var3, var4, 1));
 		var7 = true;
-		var13 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 - 1);
-		if(var6.minZ > 0.0D) {
-			var13 = var12;
-		}
-
-		if(Block.lightValue[var1.blockID] > 0) {
-			var13 = 1.0F;
-		}
-
-		var5.setColorOpaque_F(var10 * var13, var10 * var13, var10 * var13);
+		var5.func_35835_b(var1.minZ > 0.0D ? var12 : var1.func_35275_c(this.blockAccess, var2, var3, var4 - 1));
+		var5.setColorOpaque_F(var10, var10, var10);
 		int var14 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 2);
 		if(var14 < 0) {
 			this.flipTexture = true;
@@ -2597,16 +2672,8 @@
 		this.renderEastFace(var1, (double)var2, (double)var3, (double)var4, var14);
 		var7 = true;
 		this.flipTexture = false;
-		var13 = var1.getBlockBrightness(this.blockAccess, var2, var3, var4 + 1);
-		if(var6.maxZ < 1.0D) {
-			var13 = var12;
-		}
-
-		if(Block.lightValue[var1.blockID] > 0) {
-			var13 = 1.0F;
-		}
-
-		var5.setColorOpaque_F(var10 * var13, var10 * var13, var10 * var13);
+		var5.func_35835_b(var1.maxZ < 1.0D ? var12 : var1.func_35275_c(this.blockAccess, var2, var3, var4 + 1));
+		var5.setColorOpaque_F(var10, var10, var10);
 		var14 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 3);
 		if(var14 < 0) {
 			this.flipTexture = true;
@@ -2616,16 +2683,8 @@
 		this.renderWestFace(var1, (double)var2, (double)var3, (double)var4, var14);
 		var7 = true;
 		this.flipTexture = false;
-		var13 = var1.getBlockBrightness(this.blockAccess, var2 - 1, var3, var4);
-		if(var6.minX > 0.0D) {
-			var13 = var12;
-		}
-
-		if(Block.lightValue[var1.blockID] > 0) {
-			var13 = 1.0F;
-		}
-
-		var5.setColorOpaque_F(var11 * var13, var11 * var13, var11 * var13);
+		var5.func_35835_b(var1.minX > 0.0D ? var12 : var1.func_35275_c(this.blockAccess, var2 - 1, var3, var4));
+		var5.setColorOpaque_F(var11, var11, var11);
 		var14 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 4);
 		if(var14 < 0) {
 			this.flipTexture = true;
@@ -2635,16 +2694,8 @@
 		this.renderNorthFace(var1, (double)var2, (double)var3, (double)var4, var14);
 		var7 = true;
 		this.flipTexture = false;
-		var13 = var1.getBlockBrightness(this.blockAccess, var2 + 1, var3, var4);
-		if(var6.maxX < 1.0D) {
-			var13 = var12;
-		}
-
-		if(Block.lightValue[var1.blockID] > 0) {
-			var13 = 1.0F;
-		}
-
-		var5.setColorOpaque_F(var11 * var13, var11 * var13, var11 * var13);
+		var5.func_35835_b(var1.maxX < 1.0D ? var12 : var1.func_35275_c(this.blockAccess, var2 + 1, var3, var4));
+		var5.setColorOpaque_F(var11, var11, var11);
 		var14 = var1.getBlockTexture(this.blockAccess, var2, var3, var4, 5);
 		if(var14 < 0) {
 			this.flipTexture = true;
@@ -2723,12 +2774,16 @@
 		double var36 = var6 + var1.maxZ;
 		if(this.enableAO) {
 			var9.setColorOpaque_F(this.colorRedTopLeft, this.colorGreenTopLeft, this.colorBlueTopLeft);
+			var9.func_35835_b(this.field_35943_ak);
 			var9.addVertexWithUV(var28, var32, var36, var22, var26);
 			var9.setColorOpaque_F(this.colorRedBottomLeft, this.colorGreenBottomLeft, this.colorBlueBottomLeft);
+			var9.func_35835_b(this.field_35944_al);
 			var9.addVertexWithUV(var28, var32, var34, var12, var16);
 			var9.setColorOpaque_F(this.colorRedBottomRight, this.colorGreenBottomRight, this.colorBlueBottomRight);
+			var9.func_35835_b(this.field_35947_am);
 			var9.addVertexWithUV(var30, var32, var34, var20, var24);
 			var9.setColorOpaque_F(this.colorRedTopRight, this.colorGreenTopRight, this.colorBlueTopRight);
+			var9.func_35835_b(this.field_35948_an);
 			var9.addVertexWithUV(var30, var32, var36, var14, var18);
 		} else {
 			var9.addVertexWithUV(var28, var32, var36, var22, var26);
@@ -2805,12 +2860,16 @@
 		double var36 = var6 + var1.maxZ;
 		if(this.enableAO) {
 			var9.setColorOpaque_F(this.colorRedTopLeft, this.colorGreenTopLeft, this.colorBlueTopLeft);
+			var9.func_35835_b(this.field_35943_ak);
 			var9.addVertexWithUV(var30, var32, var36, var14, var18);
 			var9.setColorOpaque_F(this.colorRedBottomLeft, this.colorGreenBottomLeft, this.colorBlueBottomLeft);
+			var9.func_35835_b(this.field_35944_al);
 			var9.addVertexWithUV(var30, var32, var34, var20, var24);
 			var9.setColorOpaque_F(this.colorRedBottomRight, this.colorGreenBottomRight, this.colorBlueBottomRight);
+			var9.func_35835_b(this.field_35947_am);
 			var9.addVertexWithUV(var28, var32, var34, var12, var16);
 			var9.setColorOpaque_F(this.colorRedTopRight, this.colorGreenTopRight, this.colorBlueTopRight);
+			var9.func_35835_b(this.field_35948_an);
 			var9.addVertexWithUV(var28, var32, var36, var22, var26);
 		} else {
 			var9.addVertexWithUV(var30, var32, var36, var14, var18);
@@ -2894,12 +2953,16 @@
 		double var36 = var6 + var1.minZ;
 		if(this.enableAO) {
 			var9.setColorOpaque_F(this.colorRedTopLeft, this.colorGreenTopLeft, this.colorBlueTopLeft);
+			var9.func_35835_b(this.field_35943_ak);
 			var9.addVertexWithUV(var28, var34, var36, var20, var24);
 			var9.setColorOpaque_F(this.colorRedBottomLeft, this.colorGreenBottomLeft, this.colorBlueBottomLeft);
+			var9.func_35835_b(this.field_35944_al);
 			var9.addVertexWithUV(var30, var34, var36, var12, var16);
 			var9.setColorOpaque_F(this.colorRedBottomRight, this.colorGreenBottomRight, this.colorBlueBottomRight);
+			var9.func_35835_b(this.field_35947_am);
 			var9.addVertexWithUV(var30, var32, var36, var22, var26);
 			var9.setColorOpaque_F(this.colorRedTopRight, this.colorGreenTopRight, this.colorBlueTopRight);
+			var9.func_35835_b(this.field_35948_an);
 			var9.addVertexWithUV(var28, var32, var36, var14, var18);
 		} else {
 			var9.addVertexWithUV(var28, var34, var36, var20, var24);
@@ -2983,12 +3046,16 @@
 		double var36 = var6 + var1.maxZ;
 		if(this.enableAO) {
 			var9.setColorOpaque_F(this.colorRedTopLeft, this.colorGreenTopLeft, this.colorBlueTopLeft);
+			var9.func_35835_b(this.field_35943_ak);
 			var9.addVertexWithUV(var28, var34, var36, var12, var16);
 			var9.setColorOpaque_F(this.colorRedBottomLeft, this.colorGreenBottomLeft, this.colorBlueBottomLeft);
+			var9.func_35835_b(this.field_35944_al);
 			var9.addVertexWithUV(var28, var32, var36, var22, var26);
 			var9.setColorOpaque_F(this.colorRedBottomRight, this.colorGreenBottomRight, this.colorBlueBottomRight);
+			var9.func_35835_b(this.field_35947_am);
 			var9.addVertexWithUV(var30, var32, var36, var14, var18);
 			var9.setColorOpaque_F(this.colorRedTopRight, this.colorGreenTopRight, this.colorBlueTopRight);
+			var9.func_35835_b(this.field_35948_an);
 			var9.addVertexWithUV(var30, var34, var36, var20, var24);
 		} else {
 			var9.addVertexWithUV(var28, var34, var36, var12, var16);
@@ -3072,12 +3139,16 @@
 		double var36 = var6 + var1.maxZ;
 		if(this.enableAO) {
 			var9.setColorOpaque_F(this.colorRedTopLeft, this.colorGreenTopLeft, this.colorBlueTopLeft);
+			var9.func_35835_b(this.field_35943_ak);
 			var9.addVertexWithUV(var28, var32, var36, var20, var24);
 			var9.setColorOpaque_F(this.colorRedBottomLeft, this.colorGreenBottomLeft, this.colorBlueBottomLeft);
+			var9.func_35835_b(this.field_35944_al);
 			var9.addVertexWithUV(var28, var32, var34, var12, var16);
 			var9.setColorOpaque_F(this.colorRedBottomRight, this.colorGreenBottomRight, this.colorBlueBottomRight);
+			var9.func_35835_b(this.field_35947_am);
 			var9.addVertexWithUV(var28, var30, var34, var22, var26);
 			var9.setColorOpaque_F(this.colorRedTopRight, this.colorGreenTopRight, this.colorBlueTopRight);
+			var9.func_35835_b(this.field_35948_an);
 			var9.addVertexWithUV(var28, var30, var36, var14, var18);
 		} else {
 			var9.addVertexWithUV(var28, var32, var36, var20, var24);
@@ -3161,12 +3232,16 @@
 		double var36 = var6 + var1.maxZ;
 		if(this.enableAO) {
 			var9.setColorOpaque_F(this.colorRedTopLeft, this.colorGreenTopLeft, this.colorBlueTopLeft);
+			var9.func_35835_b(this.field_35943_ak);
 			var9.addVertexWithUV(var28, var30, var36, var22, var26);
 			var9.setColorOpaque_F(this.colorRedBottomLeft, this.colorGreenBottomLeft, this.colorBlueBottomLeft);
+			var9.func_35835_b(this.field_35944_al);
 			var9.addVertexWithUV(var28, var30, var34, var14, var18);
 			var9.setColorOpaque_F(this.colorRedBottomRight, this.colorGreenBottomRight, this.colorBlueBottomRight);
+			var9.func_35835_b(this.field_35947_am);
 			var9.addVertexWithUV(var28, var32, var34, var20, var24);
 			var9.setColorOpaque_F(this.colorRedTopRight, this.colorGreenTopRight, this.colorBlueTopRight);
+			var9.func_35835_b(this.field_35948_an);
 			var9.addVertexWithUV(var28, var32, var36, var12, var16);
 		} else {
 			var9.addVertexWithUV(var28, var30, var36, var22, var26);
--- net/minecraft/src/World.java
+++ net/minecraft/src/World.java
@@ -635,6 +635,53 @@
 		}
 	}
 
+	public int func_35457_a(EnumSkyBlock var1, int var2, int var3, int var4) {
+		if(var3 < 0) {
+			var3 = 0;
+		}
+
+		if(var3 >= 128 && var1 == EnumSkyBlock.Sky) {
+			return 15;
+		} else if(var3 >= 0 && var3 < 128 && var2 >= -30000000 && var4 >= -30000000 && var2 < 30000000 && var4 < 30000000) {
+			int var5 = var2 >> 4;
+			int var6 = var4 >> 4;
+			if(!this.chunkExists(var5, var6)) {
+				return 0;
+			} else {
+				int var7 = this.getBlockId(var2, var3, var4);
+				if(var7 != Block.stairSingle.blockID && var7 != Block.tilledField.blockID && var7 != Block.stairCompactCobblestone.blockID && var7 != Block.stairCompactPlanks.blockID) {
+					Chunk var13 = this.getChunkFromChunkCoords(var5, var6);
+					return var13.getSavedLightValue(var1, var2 & 15, var3, var4 & 15);
+				} else {
+					int var8 = this.getSavedLightValue(var1, var2, var3 + 1, var4);
+					int var9 = this.getSavedLightValue(var1, var2 + 1, var3, var4);
+					int var10 = this.getSavedLightValue(var1, var2 - 1, var3, var4);
+					int var11 = this.getSavedLightValue(var1, var2, var3, var4 + 1);
+					int var12 = this.getSavedLightValue(var1, var2, var3, var4 - 1);
+					if(var9 > var8) {
+						var8 = var9;
+					}
+
+					if(var10 > var8) {
+						var8 = var10;
+					}
+
+					if(var11 > var8) {
+						var8 = var11;
+					}
+
+					if(var12 > var8) {
+						var8 = var12;
+					}
+
+					return var8;
+				}
+			}
+		} else {
+			return var1.field_1722_c;
+		}
+	}
+
 	public int getSavedLightValue(EnumSkyBlock var1, int var2, int var3, int var4) {
 		if(var3 < 0) {
 			var3 = 0;
@@ -676,6 +723,16 @@
 		}
 	}
 
+	public int func_35451_b(int var1, int var2, int var3, int var4) {
+		int var5 = this.func_35457_a(EnumSkyBlock.Sky, var1, var2, var3);
+		int var6 = this.func_35457_a(EnumSkyBlock.Block, var1, var2, var3);
+		if(var6 < var4) {
+			var6 = var4;
+		}
+
+		return var5 << 20 | var6 << 4;
+	}
+
 	public float getBrightness(int var1, int var2, int var3, int var4) {
 		int var5 = this.getBlockLightValue(var1, var2, var3);
 		if(var5 < var4) {
@@ -1004,6 +1061,23 @@
 		var3 = (float)((double)var3 * (1.0D - (double)(this.func_27166_f(var1) * 5.0F) / 16.0D));
 		var3 = 1.0F - var3;
 		return (int)(var3 * 11.0F);
+	}
+
+	public float func_35464_b(float var1) {
+		float var2 = this.getCelestialAngle(var1);
+		float var3 = 1.0F - (MathHelper.cos(var2 * (float)Math.PI * 2.0F) * 2.0F + 0.2F);
+		if(var3 < 0.0F) {
+			var3 = 0.0F;
+		}
+
+		if(var3 > 1.0F) {
+			var3 = 1.0F;
+		}
+
+		var3 = 1.0F - var3;
+		var3 = (float)((double)var3 * (1.0D - (double)(this.func_27162_g(var1) * 5.0F) / 16.0D));
+		var3 = (float)((double)var3 * (1.0D - (double)(this.func_27166_f(var1) * 5.0F) / 16.0D));
+		return var3 * 0.8F + 0.2F;
 	}
 
 	public Vec3D func_4079_a(Entity var1, float var2) {
--- net/minecraft/src/TerrainTextureManager.java
+++ net/minecraft/src/TerrainTextureManager.java
@@ -7,10 +7,10 @@
 
 public class TerrainTextureManager {
 	private float[] field_1181_a = new float[768];
-	private int[] field_1180_b = new int[5120];
-	private int[] field_1186_c = new int[5120];
-	private int[] field_1185_d = new int[5120];
-	private int[] field_1184_e = new int[5120];
+	private int[] field_1180_b = new int[17408];
+	private int[] field_1186_c = new int[17408];
+	private int[] field_1185_d = new int[17408];
+	private int[] field_1184_e = new int[17408];
 	private int[] field_1183_f = new int[34];
 	private int[] field_1182_g = new int[768];
 
@@ -81,7 +81,7 @@
 				var1.field_1351_f = false;
 				Arrays.fill(this.field_1186_c, 0);
 				Arrays.fill(this.field_1185_d, 0);
-				Arrays.fill(this.field_1183_f, 160);
+				Arrays.fill(this.field_1183_f, 544);
 
 				for(int var8 = var6 - 1; var8 >= var4; --var8) {
 					for(int var9 = var5 - 1; var9 >= var3; --var9) {
@@ -89,102 +89,117 @@
 						int var11 = var8 - var4;
 						int var12 = var10 + var11;
 						boolean var13 = true;
-
-						for(int var14 = 0; var14 < 128; ++var14) {
-							int var15 = var11 - var10 - var14 + 160 - 16;
+						int var14 = 0;
+
+						while(true) {
+							var2.getClass();
+							if(var14 >= 128) {
+								break;
+							}
+
+							int var15 = var11 - var10 - var14 + 544 - 16;
 							if(var15 < this.field_1183_f[var12] || var15 < this.field_1183_f[var12 + 1]) {
 								Block var16 = Block.blocksList[var2.getBlockId(var9, var14, var8)];
 								if(var16 == null) {
 									var13 = false;
-								} else if(var16.blockMaterial == Material.water) {
-									int var24 = var2.getBlockId(var9, var14 + 1, var8);
-									if(var24 == 0 || Block.blocksList[var24].blockMaterial != Material.water) {
-										float var25 = (float)var14 / 127.0F * 0.6F + 0.4F;
-										float var26 = var2.getLightBrightness(var9, var14 + 1, var8) * var25;
-										if(var15 >= 0 && var15 < 160) {
-											int var27 = var12 + var15 * 32;
-											if(var12 >= 0 && var12 <= 32 && this.field_1185_d[var27] <= var14) {
-												this.field_1185_d[var27] = var14;
-												this.field_1184_e[var27] = (int)(var26 * 127.0F);
-											}
-
-											if(var12 >= -1 && var12 <= 31 && this.field_1185_d[var27 + 1] <= var14) {
-												this.field_1185_d[var27 + 1] = var14;
-												this.field_1184_e[var27 + 1] = (int)(var26 * 127.0F);
-											}
-
-											var13 = false;
-										}
-									}
 								} else {
-									if(var13) {
-										if(var15 < this.field_1183_f[var12]) {
-											this.field_1183_f[var12] = var15;
-										}
-
-										if(var15 < this.field_1183_f[var12 + 1]) {
-											this.field_1183_f[var12 + 1] = var15;
-										}
-									}
-
-									float var17 = (float)var14 / 127.0F * 0.6F + 0.4F;
-									int var18;
-									int var19;
-									float var20;
-									float var22;
-									if(var15 >= 0 && var15 < 160) {
-										var18 = var12 + var15 * 32;
-										var19 = this.field_1182_g[var16.blockID * 3 + 0];
-										var20 = (var2.getLightBrightness(var9, var14 + 1, var8) * 0.8F + 0.2F) * var17;
-										if(var12 >= 0 && this.field_1186_c[var18] <= var14) {
-											this.field_1186_c[var18] = var14;
-											this.field_1180_b[var18] = -16777216 | (int)(this.field_1181_a[var19 * 3 + 0] * var20) << 16 | (int)(this.field_1181_a[var19 * 3 + 1] * var20) << 8 | (int)(this.field_1181_a[var19 * 3 + 2] * var20);
-										}
-
-										if(var12 < 31) {
-											var22 = var20 * 0.9F;
-											if(this.field_1186_c[var18 + 1] <= var14) {
-												this.field_1186_c[var18 + 1] = var14;
-												this.field_1180_b[var18 + 1] = -16777216 | (int)(this.field_1181_a[var19 * 3 + 0] * var22) << 16 | (int)(this.field_1181_a[var19 * 3 + 1] * var22) << 8 | (int)(this.field_1181_a[var19 * 3 + 2] * var22);
-											}
-										}
-									}
-
-									if(var15 >= -1 && var15 < 159) {
-										var18 = var12 + (var15 + 1) * 32;
-										var19 = this.field_1182_g[var16.blockID * 3 + 1];
-										var20 = var2.getLightBrightness(var9 - 1, var14, var8) * 0.8F + 0.2F;
-										int var21 = this.field_1182_g[var16.blockID * 3 + 2];
-										var22 = var2.getLightBrightness(var9, var14, var8 + 1) * 0.8F + 0.2F;
-										float var23;
-										if(var12 >= 0) {
-											var23 = var20 * var17 * 0.6F;
-											if(this.field_1186_c[var18] <= var14 - 1) {
-												this.field_1186_c[var18] = var14 - 1;
-												this.field_1180_b[var18] = -16777216 | (int)(this.field_1181_a[var19 * 3 + 0] * var23) << 16 | (int)(this.field_1181_a[var19 * 3 + 1] * var23) << 8 | (int)(this.field_1181_a[var19 * 3 + 2] * var23);
-											}
-										}
-
-										if(var12 < 31) {
-											var23 = var22 * 0.9F * var17 * 0.4F;
-											if(this.field_1186_c[var18 + 1] <= var14 - 1) {
-												this.field_1186_c[var18 + 1] = var14 - 1;
-												this.field_1180_b[var18 + 1] = -16777216 | (int)(this.field_1181_a[var21 * 3 + 0] * var23) << 16 | (int)(this.field_1181_a[var21 * 3 + 1] * var23) << 8 | (int)(this.field_1181_a[var21 * 3 + 2] * var23);
+									float var10000;
+									if(var16.blockMaterial == Material.water) {
+										int var24 = var2.getBlockId(var9, var14 + 1, var8);
+										if(var24 == 0 || Block.blocksList[var24].blockMaterial != Material.water) {
+											var10000 = (float)var14;
+											var2.getClass();
+											float var25 = var10000 / (128.0F - 1.0F) * 0.6F + 0.4F;
+											float var26 = var2.getLightBrightness(var9, var14 + 1, var8) * var25;
+											if(var15 >= 0 && var15 < 544) {
+												int var27 = var12 + var15 * 32;
+												if(var12 >= 0 && var12 <= 32 && this.field_1185_d[var27] <= var14) {
+													this.field_1185_d[var27] = var14;
+													this.field_1184_e[var27] = (int)(var26 * 127.0F);
+												}
+
+												if(var12 >= -1 && var12 <= 31 && this.field_1185_d[var27 + 1] <= var14) {
+													this.field_1185_d[var27 + 1] = var14;
+													this.field_1184_e[var27 + 1] = (int)(var26 * 127.0F);
+												}
+
+												var13 = false;
+											}
+										}
+									} else {
+										if(var13) {
+											if(var15 < this.field_1183_f[var12]) {
+												this.field_1183_f[var12] = var15;
+											}
+
+											if(var15 < this.field_1183_f[var12 + 1]) {
+												this.field_1183_f[var12 + 1] = var15;
+											}
+										}
+
+										var10000 = (float)var14;
+										var2.getClass();
+										float var17 = var10000 / (128.0F - 1.0F) * 0.6F + 0.4F;
+										int var18;
+										int var19;
+										float var20;
+										float var22;
+										if(var15 >= 0 && var15 < 544) {
+											var18 = var12 + var15 * 32;
+											var19 = this.field_1182_g[var16.blockID * 3 + 0];
+											var20 = (var2.getLightBrightness(var9, var14 + 1, var8) * 0.8F + 0.2F) * var17;
+											if(var12 >= 0 && this.field_1186_c[var18] <= var14) {
+												this.field_1186_c[var18] = var14;
+												this.field_1180_b[var18] = -16777216 | (int)(this.field_1181_a[var19 * 3 + 0] * var20) << 16 | (int)(this.field_1181_a[var19 * 3 + 1] * var20) << 8 | (int)(this.field_1181_a[var19 * 3 + 2] * var20);
+											}
+
+											if(var12 < 31) {
+												var22 = var20 * 0.9F;
+												if(this.field_1186_c[var18 + 1] <= var14) {
+													this.field_1186_c[var18 + 1] = var14;
+													this.field_1180_b[var18 + 1] = -16777216 | (int)(this.field_1181_a[var19 * 3 + 0] * var22) << 16 | (int)(this.field_1181_a[var19 * 3 + 1] * var22) << 8 | (int)(this.field_1181_a[var19 * 3 + 2] * var22);
+												}
+											}
+										}
+
+										if(var15 >= -1 && var15 < 543) {
+											var18 = var12 + (var15 + 1) * 32;
+											var19 = this.field_1182_g[var16.blockID * 3 + 1];
+											var20 = var2.getLightBrightness(var9 - 1, var14, var8) * 0.8F + 0.2F;
+											int var21 = this.field_1182_g[var16.blockID * 3 + 2];
+											var22 = var2.getLightBrightness(var9, var14, var8 + 1) * 0.8F + 0.2F;
+											float var23;
+											if(var12 >= 0) {
+												var23 = var20 * var17 * 0.6F;
+												if(this.field_1186_c[var18] <= var14 - 1) {
+													this.field_1186_c[var18] = var14 - 1;
+													this.field_1180_b[var18] = -16777216 | (int)(this.field_1181_a[var19 * 3 + 0] * var23) << 16 | (int)(this.field_1181_a[var19 * 3 + 1] * var23) << 8 | (int)(this.field_1181_a[var19 * 3 + 2] * var23);
+												}
+											}
+
+											if(var12 < 31) {
+												var23 = var22 * 0.9F * var17 * 0.4F;
+												if(this.field_1186_c[var18 + 1] <= var14 - 1) {
+													this.field_1186_c[var18 + 1] = var14 - 1;
+													this.field_1180_b[var18 + 1] = -16777216 | (int)(this.field_1181_a[var21 * 3 + 0] * var23) << 16 | (int)(this.field_1181_a[var21 * 3 + 1] * var23) << 8 | (int)(this.field_1181_a[var21 * 3 + 2] * var23);
+												}
 											}
 										}
 									}
 								}
 							}
+
+							++var14;
 						}
 					}
 				}
 
 				this.func_800_a();
 				if(var1.field_1348_a == null) {
-					var1.field_1348_a = new BufferedImage(32, 160, 2);
+					var1.field_1348_a = new BufferedImage(32, 544, 2);
 				}
 
-				var1.field_1348_a.setRGB(0, 0, 32, 160, this.field_1180_b, 0, 32);
+				var1.field_1348_a.setRGB(0, 0, 32, 544, this.field_1180_b, 0, 32);
 				var1.field_1352_e = true;
 			}
 		}
@@ -192,7 +207,7 @@
 
 	private void func_800_a() {
 		for(int var1 = 0; var1 < 32; ++var1) {
-			for(int var2 = 0; var2 < 160; ++var2) {
+			for(int var2 = 0; var2 < 544; ++var2) {
 				int var3 = var1 + var2 * 32;
 				if(this.field_1186_c[var3] == 0) {
 					this.field_1180_b[var3] = 0;
--- net/minecraft/src/EntityRenderer.java
+++ net/minecraft/src/EntityRenderer.java
@@ -1,5 +1,6 @@
 package net.minecraft.src;
 
+import java.awt.image.BufferedImage;
 import java.nio.FloatBuffer;
 import java.util.List;
 import java.util.Random;
@@ -35,12 +36,19 @@
 	private float field_22221_y = 0.0F;
 	private float field_22220_z = 0.0F;
 	private float field_22230_A = 0.0F;
+	public int field_35818_d;
+	private int[] field_35811_L;
 	private boolean cloudFog = false;
 	private double cameraZoom = 1.0D;
 	private double cameraYaw = 0.0D;
 	private double cameraPitch = 0.0D;
 	private long prevFrameTime = System.currentTimeMillis();
 	private long field_28133_I = 0L;
+	private boolean field_35815_V = false;
+	float field_35819_e = 0.0F;
+	float field_35816_f = 0.0F;
+	float field_35817_g = 0.0F;
+	float field_35821_h = 0.0F;
 	private Random random = new Random();
 	private int rainSoundCounter = 0;
 	volatile int field_1394_b = 0;
@@ -55,9 +63,12 @@
 	public EntityRenderer(Minecraft var1) {
 		this.mc = var1;
 		this.itemRenderer = new ItemRenderer(var1);
+		this.field_35818_d = var1.renderEngine.allocateAndSetupTexture(new BufferedImage(16, 16, 1));
+		this.field_35811_L = new int[256];
 	}
 
 	public void updateRenderer() {
+		this.func_35807_d();
 		this.fogColor2 = this.fogColor1;
 		this.field_22227_s = this.field_22228_r;
 		this.field_22225_u = this.field_22226_t;
@@ -311,7 +322,9 @@
 		}
 
 		if(!this.mc.gameSettings.thirdPersonView && !this.mc.renderViewEntity.isPlayerSleeping() && !this.mc.gameSettings.hideGUI) {
+			this.func_35806_b((double)var1);
 			this.itemRenderer.renderItemInFirstPerson(var1);
+			this.func_35810_a((double)var1);
 		}
 
 		GL11.glPopMatrix();
@@ -326,7 +339,128 @@
 
 	}
 
+	public void func_35810_a(double var1) {
+		OpenGlHelper.setActiveTexture(OpenGlHelper.lightmapEnabled);
+		GL11.glDisable(GL11.GL_TEXTURE_2D);
+		OpenGlHelper.setActiveTexture(OpenGlHelper.lightmapDisabled);
+	}
+
+	public void func_35806_b(double var1) {
+		OpenGlHelper.setActiveTexture(OpenGlHelper.lightmapEnabled);
+		GL11.glMatrixMode(GL11.GL_TEXTURE);
+		GL11.glLoadIdentity();
+		float var3 = 0.00390625F;
+		GL11.glScalef(var3, var3, var3);
+		GL11.glTranslatef(8.0F, 8.0F, 8.0F);
+		GL11.glMatrixMode(GL11.GL_MODELVIEW);
+		this.mc.renderEngine.bindTexture(this.field_35818_d);
+		GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, GL11.GL_LINEAR);
+		GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, GL11.GL_LINEAR);
+		GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, GL11.GL_LINEAR);
+		GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, GL11.GL_LINEAR);
+		GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_S, GL11.GL_CLAMP);
+		GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_T, GL11.GL_CLAMP);
+		GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
+		GL11.glEnable(GL11.GL_TEXTURE_2D);
+		OpenGlHelper.setActiveTexture(OpenGlHelper.lightmapDisabled);
+	}
+
+	private void func_35807_d() {
+		this.field_35816_f = (float)((double)this.field_35816_f + (Math.random() - Math.random()) * Math.random() * Math.random());
+		this.field_35821_h = (float)((double)this.field_35821_h + (Math.random() - Math.random()) * Math.random() * Math.random());
+		this.field_35816_f = (float)((double)this.field_35816_f * 0.9D);
+		this.field_35821_h = (float)((double)this.field_35821_h * 0.9D);
+		this.field_35819_e += (this.field_35816_f - this.field_35819_e) * 1.0F;
+		this.field_35817_g += (this.field_35821_h - this.field_35817_g) * 1.0F;
+		this.field_35815_V = true;
+	}
+
+	private void func_35808_e() {
+		World var1 = this.mc.theWorld;
+		if(var1 != null) {
+			for(int var2 = 0; var2 < 256; ++var2) {
+				float var3 = var1.func_35464_b(1.0F) * 0.95F + 0.05F;
+				float var4 = var1.worldProvider.lightBrightnessTable[var2 / 16] * var3;
+				float var5 = var1.worldProvider.lightBrightnessTable[var2 % 16] * (this.field_35819_e * 0.1F + 1.5F);
+				if(var1.field_27172_i > 0) {
+					var4 = var1.worldProvider.lightBrightnessTable[var2 / 16];
+				}
+
+				float var6 = var4 * (var1.func_35464_b(1.0F) * 0.65F + 0.35F);
+				float var7 = var4 * (var1.func_35464_b(1.0F) * 0.65F + 0.35F);
+				float var10 = var5 * ((var5 * 0.6F + 0.4F) * 0.6F + 0.4F);
+				float var11 = var5 * (var5 * var5 * 0.6F + 0.4F);
+				float var12 = var6 + var5;
+				float var13 = var7 + var10;
+				float var14 = var4 + var11;
+				var12 = var12 * 0.96F + 0.03F;
+				var13 = var13 * 0.96F + 0.03F;
+				var14 = var14 * 0.96F + 0.03F;
+				float var15 = 0.0F;
+				if(var12 > 1.0F) {
+					var12 = 1.0F;
+				}
+
+				if(var13 > 1.0F) {
+					var13 = 1.0F;
+				}
+
+				if(var14 > 1.0F) {
+					var14 = 1.0F;
+				}
+
+				float var16 = 1.0F - var12;
+				float var17 = 1.0F - var13;
+				float var18 = 1.0F - var14;
+				var16 = 1.0F - var16 * var16 * var16 * var16;
+				var17 = 1.0F - var17 * var17 * var17 * var17;
+				var18 = 1.0F - var18 * var18 * var18 * var18;
+				var12 = var12 * (1.0F - var15) + var16 * var15;
+				var13 = var13 * (1.0F - var15) + var17 * var15;
+				var14 = var14 * (1.0F - var15) + var18 * var15;
+				var12 = var12 * 0.96F + 0.03F;
+				var13 = var13 * 0.96F + 0.03F;
+				var14 = var14 * 0.96F + 0.03F;
+				if(var12 > 1.0F) {
+					var12 = 1.0F;
+				}
+
+				if(var13 > 1.0F) {
+					var13 = 1.0F;
+				}
+
+				if(var14 > 1.0F) {
+					var14 = 1.0F;
+				}
+
+				if(var12 < 0.0F) {
+					var12 = 0.0F;
+				}
+
+				if(var13 < 0.0F) {
+					var13 = 0.0F;
+				}
+
+				if(var14 < 0.0F) {
+					var14 = 0.0F;
+				}
+
+				short var19 = 255;
+				int var20 = (int)(var12 * 255.0F);
+				int var21 = (int)(var13 * 255.0F);
+				int var22 = (int)(var14 * 255.0F);
+				this.field_35811_L[var2] = var19 << 24 | var20 << 16 | var21 << 8 | var22;
+			}
+
+			this.mc.renderEngine.createTextureFromBytes(this.field_35811_L, 16, 16, this.field_35818_d);
+		}
+	}
+
 	public void updateCameraAndRender(float var1) {
+		if(this.field_35815_V) {
+			this.func_35808_e();
+		}
+
 		if(!Display.isActive()) {
 			if(System.currentTimeMillis() - this.prevFrameTime > 500L) {
 				this.mc.displayInGameMenu();
@@ -430,6 +564,10 @@
 	}
 
 	public void renderWorld(float var1, long var2) {
+		if(this.field_35815_V) {
+			this.func_35808_e();
+		}
+
 		GL11.glEnable(GL11.GL_CULL_FACE);
 		GL11.glEnable(GL11.GL_DEPTH_TEST);
 		if(this.mc.renderViewEntity == null) {
@@ -499,10 +637,12 @@
 			GL11.glShadeModel(GL11.GL_FLAT);
 			RenderHelper.enableStandardItemLighting();
 			var5.renderEntities(var4.getPosition(var1), var19, var1);
+			this.func_35806_b((double)var1);
 			var6.func_1187_b(var4, var1);
 			RenderHelper.disableStandardItemLighting();
 			this.setupFog(0, var1);
 			var6.renderParticles(var4, var1);
+			this.func_35810_a((double)var1);
 			EntityPlayer var21;
 			if(this.mc.objectMouseOver != null && var4.isInsideOfMaterial(Material.water) && var4 instanceof EntityPlayer) {
 				var21 = (EntityPlayer)var4;
@@ -636,6 +776,7 @@
 	protected void renderRainSnow(float var1) {
 		float var2 = this.mc.theWorld.func_27162_g(var1);
 		if(var2 > 0.0F) {
+			this.func_35806_b((double)var1);
 			EntityLiving var3 = this.mc.renderViewEntity;
 			World var4 = this.mc.theWorld;
 			int var5 = MathHelper.floor_double(var3.posX);
@@ -750,8 +891,9 @@
 							double var39 = (double)((float)var20 + 0.5F) - var3.posZ;
 							float var40 = MathHelper.sqrt_double(var38 * var38 + var39 * var39) / (float)var16;
 							var8.startDrawingQuads();
-							float var32 = var4.getLightBrightness(var19, 128, var20) * 0.85F + 0.15F;
-							GL11.glColor4f(var32, var32, var32, ((1.0F - var40 * var40) * 0.5F + 0.5F) * var2);
+							float var32 = 1.0F;
+							var8.func_35835_b((var4.func_35451_b(var19, var24, var20, 0) * 3 + 15728880) / 4);
+							var8.setColorRGBA_F(var32, var32, var32, ((1.0F - var40 * var40) * 0.3F + 0.5F) * var2);
 							var8.setTranslationD(-var9 * 1.0D, -var11 * 1.0D, -var13 * 1.0D);
 							var8.addVertexWithUV((double)(var19 + 0), (double)var23, (double)var20 + 0.5D, (double)(0.0F * var37), (double)((float)var23 * var37 / 4.0F + var26 * var37));
 							var8.addVertexWithUV((double)(var19 + 1), (double)var23, (double)var20 + 0.5D, (double)(1.0F * var37), (double)((float)var23 * var37 / 4.0F + var26 * var37));
@@ -771,6 +913,7 @@
 			GL11.glEnable(GL11.GL_CULL_FACE);
 			GL11.glDisable(GL11.GL_BLEND);
 			GL11.glAlphaFunc(GL11.GL_GREATER, 0.1F);
+			this.func_35810_a((double)var1);
 		}
 	}
 
--- net/minecraft/src/ChunkCache.java
+++ net/minecraft/src/ChunkCache.java
@@ -54,6 +54,16 @@
 		return this.worldObj.worldProvider.lightBrightnessTable[var5];
 	}
 
+	public int func_35451_b(int var1, int var2, int var3, int var4) {
+		int var5 = this.func_35454_a(EnumSkyBlock.Sky, var1, var2, var3);
+		int var6 = this.func_35454_a(EnumSkyBlock.Block, var1, var2, var3);
+		if(var6 < var4) {
+			var6 = var4;
+		}
+
+		return var5 << 20 | var6 << 4;
+	}
+
 	public float getLightBrightness(int var1, int var2, int var3) {
 		return this.worldObj.worldProvider.lightBrightnessTable[this.getLightValue(var1, var2, var3)];
 	}
@@ -142,5 +152,78 @@
 	public boolean isBlockNormalCube(int var1, int var2, int var3) {
 		Block var4 = Block.blocksList[this.getBlockId(var1, var2, var3)];
 		return var4 == null ? false : var4.blockMaterial.getIsSolid() && var4.renderAsNormalBlock();
+	}
+
+	public int func_35454_a(EnumSkyBlock var1, int var2, int var3, int var4) {
+		if(var3 < 0) {
+			var3 = 0;
+		}
+
+		this.worldObj.getClass();
+		if(var3 >= 128) {
+			this.worldObj.getClass();
+			var3 = 128 - 1;
+		}
+
+		if(var3 >= 0) {
+			this.worldObj.getClass();
+			if(var3 < 128 && var2 >= -30000000 && var4 >= -30000000 && var2 < 30000000 && var4 <= 30000000) {
+				int var5 = this.getBlockId(var2, var3, var4);
+				int var6;
+				if(var5 != Block.stairSingle.blockID && var5 != Block.tilledField.blockID && var5 != Block.stairCompactCobblestone.blockID && var5 != Block.stairCompactPlanks.blockID) {
+					var5 = (var2 >> 4) - this.chunkX;
+					var6 = (var4 >> 4) - this.chunkZ;
+					return this.chunkArray[var5][var6].getSavedLightValue(var1, var2 & 15, var3, var4 & 15);
+				}
+
+				var6 = this.func_35453_b(var1, var2, var3 + 1, var4);
+				int var7 = this.func_35453_b(var1, var2 + 1, var3, var4);
+				int var8 = this.func_35453_b(var1, var2 - 1, var3, var4);
+				int var9 = this.func_35453_b(var1, var2, var3, var4 + 1);
+				int var10 = this.func_35453_b(var1, var2, var3, var4 - 1);
+				if(var7 > var6) {
+					var6 = var7;
+				}
+
+				if(var8 > var6) {
+					var6 = var8;
+				}
+
+				if(var9 > var6) {
+					var6 = var9;
+				}
+
+				if(var10 > var6) {
+					var6 = var10;
+				}
+
+				return var6;
+			}
+		}
+
+		return var1.field_1722_c;
+	}
+
+	public int func_35453_b(EnumSkyBlock var1, int var2, int var3, int var4) {
+		if(var3 < 0) {
+			var3 = 0;
+		}
+
+		this.worldObj.getClass();
+		if(var3 >= 128) {
+			this.worldObj.getClass();
+			var3 = 128 - 1;
+		}
+
+		if(var3 >= 0) {
+			this.worldObj.getClass();
+			if(var3 < 128 && var2 >= -30000000 && var4 >= -30000000 && var2 < 30000000 && var4 <= 30000000) {
+				int var5 = (var2 >> 4) - this.chunkX;
+				int var6 = (var4 >> 4) - this.chunkZ;
+				return this.chunkArray[var5][var6].getSavedLightValue(var1, var2 & 15, var3, var4 & 15);
+			}
+		}
+
+		return var1.field_1722_c;
 	}
 }
--- net/minecraft/src/RenderManager.java
+++ net/minecraft/src/RenderManager.java
@@ -104,8 +104,11 @@
 		double var5 = var1.lastTickPosY + (var1.posY - var1.lastTickPosY) * (double)var2;
 		double var7 = var1.lastTickPosZ + (var1.posZ - var1.lastTickPosZ) * (double)var2;
 		float var9 = var1.prevRotationYaw + (var1.rotationYaw - var1.prevRotationYaw) * var2;
-		float var10 = var1.getEntityBrightness(var2);
-		GL11.glColor3f(var10, var10, var10);
+		int var10 = var1.func_35115_a(var2);
+		int var11 = var10 % 65536;
+		int var12 = var10 / 65536;
+		OpenGlHelper.setLightmapTextureCoords(OpenGlHelper.lightmapEnabled, (float)var11 / 1.0F, (float)var12 / 1.0F);
+		GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
 		this.renderEntityWithPosYaw(var1, var3 - renderPosX, var5 - renderPosY, var7 - renderPosZ, var9, var2);
 	}
 
--- net/minecraft/src/GuiIngame.java
+++ net/minecraft/src/GuiIngame.java
@@ -135,10 +135,7 @@
 
 		GL11.glDisable(GL11.GL_BLEND);
 		GL11.glEnable(GL12.GL_RESCALE_NORMAL);
-		GL11.glPushMatrix();
-		GL11.glRotatef(120.0F, 1.0F, 0.0F, 0.0F);
-		RenderHelper.enableStandardItemLighting();
-		GL11.glPopMatrix();
+		RenderHelper.func_41089_c();
 
 		for(var15 = 0; var15 < 9; ++var15) {
 			var16 = var6 / 2 - 90 + var15 * 20 + 2;
--- net/minecraft/src/EntityFlameFX.java
+++ net/minecraft/src/EntityFlameFX.java
@@ -24,6 +24,27 @@
 		super.renderParticle(var1, var2, var3, var4, var5, var6, var7);
 	}
 
+	public int func_35115_a(float var1) {
+		float var2 = ((float)this.particleAge + var1) / (float)this.particleMaxAge;
+		if(var2 < 0.0F) {
+			var2 = 0.0F;
+		}
+
+		if(var2 > 1.0F) {
+			var2 = 1.0F;
+		}
+
+		int var3 = super.func_35115_a(var1);
+		int var4 = var3 & 255;
+		int var5 = var3 >> 16 & 255;
+		var4 += (int)(var2 * 15.0F * 16.0F);
+		if(var4 > 240) {
+			var4 = 240;
+		}
+
+		return var4 | var5 << 16;
+	}
+
 	public float getEntityBrightness(float var1) {
 		float var2 = ((float)this.particleAge + var1) / (float)this.particleMaxAge;
 		if(var2 < 0.0F) {
--- net/minecraft/src/IBlockAccess.java
+++ net/minecraft/src/IBlockAccess.java
@@ -5,6 +5,8 @@
 
 	TileEntity getBlockTileEntity(int var1, int var2, int var3);
 
+	int func_35451_b(int var1, int var2, int var3, int var4);
+
 	float getBrightness(int var1, int var2, int var3, int var4);
 
 	float getLightBrightness(int var1, int var2, int var3);
--- net/minecraft/src/EntityLavaFX.java
+++ net/minecraft/src/EntityLavaFX.java
@@ -17,6 +17,22 @@
 		this.particleTextureIndex = 49;
 	}
 
+	public int func_35115_a(float var1) {
+		float var2 = ((float)this.particleAge + var1) / (float)this.particleMaxAge;
+		if(var2 < 0.0F) {
+			var2 = 0.0F;
+		}
+
+		if(var2 > 1.0F) {
+			var2 = 1.0F;
+		}
+
+		int var3 = super.func_35115_a(var1);
+		short var4 = 240;
+		int var5 = var3 >> 16 & 255;
+		return var4 | var5 << 16;
+	}
+
 	public float getEntityBrightness(float var1) {
 		return 1.0F;
 	}
--- net/minecraft/src/GuiContainer.java
+++ net/minecraft/src/GuiContainer.java
@@ -24,15 +24,16 @@
 		int var4 = (this.width - this.xSize) / 2;
 		int var5 = (this.height - this.ySize) / 2;
 		this.drawGuiContainerBackgroundLayer(var3);
-		GL11.glPushMatrix();
-		GL11.glRotatef(120.0F, 1.0F, 0.0F, 0.0F);
-		RenderHelper.enableStandardItemLighting();
-		GL11.glPopMatrix();
+		RenderHelper.func_41089_c();
 		GL11.glPushMatrix();
 		GL11.glTranslatef((float)var4, (float)var5, 0.0F);
 		GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
 		GL11.glEnable(GL12.GL_RESCALE_NORMAL);
 		Slot var6 = null;
+		short var80 = 240;
+		short var81 = 240;
+		OpenGlHelper.setLightmapTextureCoords(OpenGlHelper.lightmapEnabled, (float)var80 / 1.0F, (float)var81 / 1.0F);
+		GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
 
 		int var9;
 		int var10;
--- net/minecraft/src/EntityFX.java
+++ net/minecraft/src/EntityFX.java
@@ -85,7 +85,7 @@
 		float var13 = (float)(this.prevPosX + (this.posX - this.prevPosX) * (double)var2 - interpPosX);
 		float var14 = (float)(this.prevPosY + (this.posY - this.prevPosY) * (double)var2 - interpPosY);
 		float var15 = (float)(this.prevPosZ + (this.posZ - this.prevPosZ) * (double)var2 - interpPosZ);
-		float var16 = this.getEntityBrightness(var2);
+		float var16 = 1.0F;
 		var1.setColorOpaque_F(this.particleRed * var16, this.particleGreen * var16, this.particleBlue * var16);
 		var1.addVertexWithUV((double)(var13 - var3 * var12 - var6 * var12), (double)(var14 - var4 * var12), (double)(var15 - var5 * var12 - var7 * var12), (double)var9, (double)var11);
 		var1.addVertexWithUV((double)(var13 - var3 * var12 + var6 * var12), (double)(var14 + var4 * var12), (double)(var15 - var5 * var12 + var7 * var12), (double)var9, (double)var10);
--- net/minecraft/src/RenderLiving.java
+++ net/minecraft/src/RenderLiving.java
@@ -64,6 +64,9 @@
 			this.renderEquippedItems(var1, var9);
 			float var25 = var1.getEntityBrightness(var9);
 			int var18 = this.getColorMultiplier(var1, var25, var9);
+			OpenGlHelper.setActiveTexture(OpenGlHelper.lightmapEnabled);
+			GL11.glDisable(GL11.GL_TEXTURE_2D);
+			OpenGlHelper.setActiveTexture(OpenGlHelper.lightmapDisabled);
 			if((var18 >> 24 & 255) > 0 || var1.hurtTime > 0 || var1.deathTime > 0) {
 				GL11.glDisable(GL11.GL_TEXTURE_2D);
 				GL11.glDisable(GL11.GL_ALPHA_TEST);
@@ -109,6 +112,9 @@
 			var24.printStackTrace();
 		}
 
+		OpenGlHelper.setActiveTexture(OpenGlHelper.lightmapEnabled);
+		GL11.glEnable(GL11.GL_TEXTURE_2D);
+		OpenGlHelper.setActiveTexture(OpenGlHelper.lightmapDisabled);
 		GL11.glEnable(GL11.GL_CULL_FACE);
 		GL11.glPopMatrix();
 		this.passSpecialRender(var1, var2, var4, var6);
--- /dev/null
+++ net/minecraft/src/OpenGlHelper.java
@@ -1,0 +1,50 @@
+package net.minecraft.src;
+
+import org.lwjgl.opengl.ARBMultitexture;
+import org.lwjgl.opengl.GL13;
+import org.lwjgl.opengl.GLContext;
+
+public class OpenGlHelper {
+	public static int lightmapDisabled;
+	public static int lightmapEnabled;
+	private static boolean useMultitextureARB = false;
+
+	public static void initializeTextures() {
+		useMultitextureARB = GLContext.getCapabilities().GL_ARB_multitexture && !GLContext.getCapabilities().OpenGL13;
+		if(useMultitextureARB) {
+			lightmapDisabled = '\u84c0';
+			lightmapEnabled = '\u84c1';
+		} else {
+			lightmapDisabled = '\u84c0';
+			lightmapEnabled = '\u84c1';
+		}
+
+	}
+
+	public static void setActiveTexture(int var0) {
+		if(useMultitextureARB) {
+			ARBMultitexture.glActiveTextureARB(var0);
+		} else {
+			GL13.glActiveTexture(var0);
+		}
+
+	}
+
+	public static void setClientActiveTexture(int var0) {
+		if(useMultitextureARB) {
+			ARBMultitexture.glClientActiveTextureARB(var0);
+		} else {
+			GL13.glClientActiveTexture(var0);
+		}
+
+	}
+
+	public static void setLightmapTextureCoords(int var0, float var1, float var2) {
+		if(useMultitextureARB) {
+			ARBMultitexture.glMultiTexCoord2fARB(var0, var1, var2);
+		} else {
+			GL13.glMultiTexCoord2f(var0, var1, var2);
+		}
+
+	}
+}
--- net/minecraft/src/EntityDiggingFX.java
+++ net/minecraft/src/EntityDiggingFX.java
@@ -39,7 +39,7 @@
 		float var13 = (float)(this.prevPosX + (this.posX - this.prevPosX) * (double)var2 - interpPosX);
 		float var14 = (float)(this.prevPosY + (this.posY - this.prevPosY) * (double)var2 - interpPosY);
 		float var15 = (float)(this.prevPosZ + (this.posZ - this.prevPosZ) * (double)var2 - interpPosZ);
-		float var16 = this.getEntityBrightness(var2);
+		float var16 = 1.0F;
 		var1.setColorOpaque_F(var16 * this.particleRed, var16 * this.particleGreen, var16 * this.particleBlue);
 		var1.addVertexWithUV((double)(var13 - var3 * var12 - var6 * var12), (double)(var14 - var4 * var12), (double)(var15 - var5 * var12 - var7 * var12), (double)var8, (double)var11);
 		var1.addVertexWithUV((double)(var13 - var3 * var12 + var6 * var12), (double)(var14 + var4 * var12), (double)(var15 - var5 * var12 + var7 * var12), (double)var8, (double)var10);
--- net/minecraft/src/BlockStairs.java
+++ net/minecraft/src/BlockStairs.java
@@ -78,6 +78,10 @@
 		this.modelBlock.onBlockDestroyedByPlayer(var1, var2, var3, var4, var5);
 	}
 
+	public int func_35275_c(IBlockAccess var1, int var2, int var3, int var4) {
+		return this.modelBlock.func_35275_c(var1, var2, var3, var4);
+	}
+
 	public float getBlockBrightness(IBlockAccess var1, int var2, int var3, int var4) {
 		return this.modelBlock.getBlockBrightness(var1, var2, var3, var4);
 	}
--- net/minecraft/src/RenderEngine.java
+++ net/minecraft/src/RenderEngine.java
@@ -243,6 +243,57 @@
 
 	}
 
+	public void createTextureFromBytes(int[] var1, int var2, int var3, int var4) {
+		GL11.glBindTexture(GL11.GL_TEXTURE_2D, var4);
+		if(useMipmaps) {
+			GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, GL11.GL_NEAREST_MIPMAP_LINEAR);
+			GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, GL11.GL_NEAREST);
+		} else {
+			GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, GL11.GL_NEAREST);
+			GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, GL11.GL_NEAREST);
+		}
+
+		if(this.blurTexture) {
+			GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, GL11.GL_LINEAR);
+			GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, GL11.GL_LINEAR);
+		}
+
+		if(this.clampTexture) {
+			GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_S, GL11.GL_CLAMP);
+			GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_T, GL11.GL_CLAMP);
+		} else {
+			GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_S, GL11.GL_REPEAT);
+			GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_T, GL11.GL_REPEAT);
+		}
+
+		byte[] var5 = new byte[var2 * var3 * 4];
+
+		for(int var6 = 0; var6 < var1.length; ++var6) {
+			int var7 = var1[var6] >> 24 & 255;
+			int var8 = var1[var6] >> 16 & 255;
+			int var9 = var1[var6] >> 8 & 255;
+			int var10 = var1[var6] & 255;
+			if(this.options != null && this.options.anaglyph) {
+				int var11 = (var8 * 30 + var9 * 59 + var10 * 11) / 100;
+				int var12 = (var8 * 30 + var9 * 70) / 100;
+				int var13 = (var8 * 30 + var10 * 70) / 100;
+				var8 = var11;
+				var9 = var12;
+				var10 = var13;
+			}
+
+			var5[var6 * 4 + 0] = (byte)var8;
+			var5[var6 * 4 + 1] = (byte)var9;
+			var5[var6 * 4 + 2] = (byte)var10;
+			var5[var6 * 4 + 3] = (byte)var7;
+		}
+
+		this.imageData.clear();
+		this.imageData.put(var5);
+		this.imageData.position(0).limit(var5.length);
+		GL11.glTexSubImage2D(GL11.GL_TEXTURE_2D, 0, 0, 0, var2, var3, GL11.GL_RGBA, GL11.GL_UNSIGNED_BYTE, (ByteBuffer)this.imageData);
+	}
+
 	public void func_28150_a(int[] var1, int var2, int var3, int var4) {
 		GL11.glBindTexture(GL11.GL_TEXTURE_2D, var4);
 		if(useMipmaps) {
--- net/minecraft/client/Minecraft.java
+++ net/minecraft/client/Minecraft.java
@@ -59,6 +59,7 @@
 import net.minecraft.src.MovingObjectPosition;
 import net.minecraft.src.NetClientHandler;
 import net.minecraft.src.OpenGlCapsChecker;
+import net.minecraft.src.OpenGlHelper;
 import net.minecraft.src.PlayerController;
 import net.minecraft.src.PlayerControllerTest;
 import net.minecraft.src.RenderBlocks;
@@ -233,6 +234,7 @@
 			Display.create();
 		}
 
+		OpenGlHelper.initializeTextures();
 		this.mcDataDir = getMinecraftDir();
 		this.saveLoader = new SaveConverterMcRegion(new File(this.mcDataDir, "saves"));
 		this.gameSettings = new GameSettings(this, this.mcDataDir);
--- net/minecraft/src/EntityPickupFX.java
+++ net/minecraft/src/EntityPickupFX.java
@@ -32,11 +32,14 @@
 		int var27 = MathHelper.floor_double(var21);
 		int var28 = MathHelper.floor_double(var23 + (double)(this.yOffset / 2.0F));
 		int var29 = MathHelper.floor_double(var25);
-		float var30 = this.worldObj.getLightBrightness(var27, var28, var29);
+		int var30 = this.func_35115_a(var2);
+		int var31 = var30 % 65536;
+		int var32 = var30 / 65536;
+		OpenGlHelper.setLightmapTextureCoords(OpenGlHelper.lightmapEnabled, (float)var31 / 1.0F, (float)var32 / 1.0F);
+		GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
 		var21 -= interpPosX;
 		var23 -= interpPosY;
 		var25 -= interpPosZ;
-		GL11.glColor4f(var30, var30, var30, 1.0F);
 		RenderManager.instance.renderEntityWithPosYaw(this.field_675_a, (double)((float)var21), (double)((float)var23), (double)((float)var25), this.field_675_a.rotationYaw, var2);
 	}
 
--- net/minecraft/src/GuiAchievement.java
+++ net/minecraft/src/GuiAchievement.java
@@ -106,10 +106,7 @@
 					this.theGame.fontRenderer.drawString(this.field_25084_e, var5 + 30, var6 + 18, -1);
 				}
 
-				GL11.glPushMatrix();
-				GL11.glRotatef(180.0F, 1.0F, 0.0F, 0.0F);
-				RenderHelper.enableStandardItemLighting();
-				GL11.glPopMatrix();
+				RenderHelper.func_41089_c();
 				GL11.glDisable(GL11.GL_LIGHTING);
 				GL11.glEnable(GL12.GL_RESCALE_NORMAL);
 				GL11.glEnable(GL11.GL_COLOR_MATERIAL);
--- net/minecraft/src/RenderGlobal.java
+++ net/minecraft/src/RenderGlobal.java
@@ -268,6 +268,7 @@
 			TileEntityRenderer.staticPlayerX = var4.lastTickPosX + (var4.posX - var4.lastTickPosX) * (double)var3;
 			TileEntityRenderer.staticPlayerY = var4.lastTickPosY + (var4.posY - var4.lastTickPosY) * (double)var3;
 			TileEntityRenderer.staticPlayerZ = var4.lastTickPosZ + (var4.posZ - var4.lastTickPosZ) * (double)var3;
+			this.mc.entityRenderer.func_35806_b((double)var3);
 			List var5 = this.worldObj.getLoadedEntityList();
 			this.countEntitiesTotal = var5.size();
 
@@ -304,6 +305,7 @@
 				TileEntityRenderer.instance.renderTileEntity((TileEntity)this.tileEntities.get(var6), var3);
 			}
 
+			this.mc.entityRenderer.func_35810_a((double)var3);
 		}
 	}
 
@@ -588,10 +590,13 @@
 	}
 
 	public void renderAllRenderLists(int var1, double var2) {
+		this.mc.entityRenderer.func_35806_b(var2);
+
 		for(int var4 = 0; var4 < this.allRenderLists.length; ++var4) {
 			this.allRenderLists[var4].func_860_a();
 		}
 
+		this.mc.entityRenderer.func_35810_a(var2);
 	}
 
 	public void updateClouds() {
@@ -1340,13 +1345,6 @@
 	}
 
 	public void updateAllRenderers() {
-		for(int var1 = 0; var1 < this.worldRenderers.length; ++var1) {
-			if(this.worldRenderers[var1].isChunkLit && !this.worldRenderers[var1].needsUpdate) {
-				this.worldRenderersToUpdate.add(this.worldRenderers[var1]);
-				this.worldRenderers[var1].markDirty();
-			}
-		}
-
 	}
 
 	public void doNothingWithTileEntity(int var1, int var2, int var3, TileEntity var4) {
--- net/minecraft/src/BlockFluid.java
+++ net/minecraft/src/BlockFluid.java
@@ -176,6 +176,16 @@
 		return this.blockMaterial == Material.water ? 5 : (this.blockMaterial == Material.lava ? 30 : 0);
 	}
 
+	public int func_35275_c(IBlockAccess var1, int var2, int var3, int var4) {
+		int var5 = var1.func_35451_b(var2, var3, var4, 0);
+		int var6 = var1.func_35451_b(var2, var3 + 1, var4, 0);
+		int var7 = var5 & 255;
+		int var8 = var6 & 255;
+		int var9 = var5 >> 16 & 255;
+		int var10 = var6 >> 16 & 255;
+		return (var7 > var8 ? var7 : var8) | (var9 > var10 ? var9 : var10) << 16;
+	}
+
 	public float getBlockBrightness(IBlockAccess var1, int var2, int var3, int var4) {
 		float var5 = var1.getLightBrightness(var2, var3, var4);
 		float var6 = var1.getLightBrightness(var2, var3 + 1, var4);
--- net/minecraft/src/GuiAchievements.java
+++ net/minecraft/src/GuiAchievements.java
@@ -231,10 +231,7 @@
 
 		Achievement var27 = null;
 		RenderItem var29 = new RenderItem();
-		GL11.glPushMatrix();
-		GL11.glRotatef(180.0F, 1.0F, 0.0F, 0.0F);
-		RenderHelper.enableStandardItemLighting();
-		GL11.glPopMatrix();
+		RenderHelper.func_41089_c();
 		GL11.glDisable(GL11.GL_LIGHTING);
 		GL11.glEnable(GL12.GL_RESCALE_NORMAL);
 		GL11.glEnable(GL11.GL_COLOR_MATERIAL);
--- net/minecraft/src/EffectRenderer.java
+++ net/minecraft/src/EffectRenderer.java
@@ -73,10 +73,12 @@
 
 				GL11.glBindTexture(GL11.GL_TEXTURE_2D, var9);
 				Tessellator var10 = Tessellator.instance;
+				GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
 				var10.startDrawingQuads();
 
 				for(int var11 = 0; var11 < this.fxLayers[var8].size(); ++var11) {
 					EntityFX var12 = (EntityFX)this.fxLayers[var8].get(var11);
+					var10.func_35835_b(var12.func_35115_a(var2));
 					var12.renderParticle(var10, var2, var3, var7, var4, var5, var6);
 				}
 
@@ -93,6 +95,7 @@
 
 			for(int var5 = 0; var5 < this.fxLayers[var3].size(); ++var5) {
 				EntityFX var6 = (EntityFX)this.fxLayers[var3].get(var5);
+				var4.func_35835_b(var6.func_35115_a(var2));
 				var6.renderParticle(var4, var2, 0.0F, 0.0F, 0.0F, 0.0F, 0.0F);
 			}
 
--- net/minecraft/src/Entity.java
+++ net/minecraft/src/Entity.java
@@ -584,6 +584,20 @@
 		}
 	}
 
+	public int func_35115_a(float var1) {
+		int var2 = MathHelper.floor_double(this.posX);
+		int var3 = MathHelper.floor_double(this.posZ);
+		World var10000 = this.worldObj;
+		this.worldObj.getClass();
+		if(var10000.blockExists(var2, 128 / 2, var3)) {
+			double var4 = (this.boundingBox.maxY - this.boundingBox.minY) * 0.66D;
+			int var6 = MathHelper.floor_double(this.posY - (double)this.yOffset + var4);
+			return this.worldObj.func_35451_b(var2, var6, var3, 0);
+		} else {
+			return 0;
+		}
+	}
+
 	public float getEntityBrightness(float var1) {
 		int var2 = MathHelper.floor_double(this.posX);
 		double var3 = (this.boundingBox.maxY - this.boundingBox.minY) * 0.66D;
--- net/minecraft/src/TileEntityRenderer.java
+++ net/minecraft/src/TileEntityRenderer.java
@@ -69,8 +69,11 @@
 
 	public void renderTileEntity(TileEntity var1, float var2) {
 		if(var1.getDistanceFrom(this.playerX, this.playerY, this.playerZ) < 4096.0D) {
-			float var3 = this.worldObj.getLightBrightness(var1.xCoord, var1.yCoord, var1.zCoord);
-			GL11.glColor3f(var3, var3, var3);
+			int var3 = this.worldObj.func_35451_b(var1.xCoord, var1.yCoord, var1.zCoord, 0);
+			int var4 = var3 % 65536;
+			int var5 = var3 / 65536;
+			OpenGlHelper.setLightmapTextureCoords(OpenGlHelper.lightmapEnabled, (float)var4 / 1.0F, (float)var5 / 1.0F);
+			GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
 			this.renderTileEntityAt(var1, (double)var1.xCoord - staticPlayerX, (double)var1.yCoord - staticPlayerY, (double)var1.zCoord - staticPlayerZ, var2);
 		}
 
--- net/minecraft/src/Block.java
+++ net/minecraft/src/Block.java
@@ -232,6 +232,10 @@
 		return var1.getBrightness(var2, var3, var4, lightValue[this.blockID]);
 	}
 
+	public int func_35275_c(IBlockAccess var1, int var2, int var3, int var4) {
+		return var1.func_35451_b(var2, var3, var4, lightValue[this.blockID]);
+	}
+
 	public boolean shouldSideBeRendered(IBlockAccess var1, int var2, int var3, int var4, int var5) {
 		return var5 == 0 && this.minY > 0.0D ? true : (var5 == 1 && this.maxY < 1.0D ? true : (var5 == 2 && this.minZ > 0.0D ? true : (var5 == 3 && this.maxZ < 1.0D ? true : (var5 == 4 && this.minX > 0.0D ? true : (var5 == 5 && this.maxX < 1.0D ? true : !var1.isBlockOpaqueCube(var2, var3, var4))))));
 	}
@@ -557,6 +561,10 @@
 
 	public int getMobilityFlag() {
 		return this.blockMaterial.getMaterialMobility();
+	}
+
+	public float func_35276_e(IBlockAccess var1, int var2, int var3, int var4) {
+		return var1.isBlockNormalCube(var2, var3, var4) ? 0.2F : 1.0F;
 	}
 
 	static {
--- net/minecraft/src/RenderHelper.java
+++ net/minecraft/src/RenderHelper.java
@@ -46,4 +46,12 @@
 		field_1695_a.flip();
 		return field_1695_a;
 	}
+
+	public static void func_41089_c() {
+		GL11.glPushMatrix();
+		GL11.glRotatef(-30.0F, 0.0F, 1.0F, 0.0F);
+		GL11.glRotatef(165.0F, 1.0F, 0.0F, 0.0F);
+		enableStandardItemLighting();
+		GL11.glPopMatrix();
+	}
 }
--- net/minecraft/src/Tessellator.java
+++ net/minecraft/src/Tessellator.java
@@ -4,24 +4,28 @@
 import java.nio.ByteOrder;
 import java.nio.FloatBuffer;
 import java.nio.IntBuffer;
+import java.nio.ShortBuffer;
 import org.lwjgl.opengl.ARBVertexBufferObject;
 import org.lwjgl.opengl.GL11;
 import org.lwjgl.opengl.GL15;
 import org.lwjgl.opengl.GLContext;
 
 public class Tessellator {
-	private static boolean convertQuadsToTriangles = true;
+	private static boolean convertQuadsToTriangles = false;
 	private static boolean tryVBO = false;
 	private ByteBuffer byteBuffer;
 	private IntBuffer intBuffer;
 	private FloatBuffer floatBuffer;
+	private ShortBuffer field_35836_g;
 	private int[] rawBuffer;
 	private int vertexCount = 0;
 	private double textureU;
 	private double textureV;
+	private int field_35837_l;
 	private int color;
 	private boolean hasColor = false;
 	private boolean hasTexture = false;
+	private boolean field_35838_p = false;
 	private boolean hasNormals = false;
 	private int rawBufferIndex = 0;
 	private int addedVertices = 0;
@@ -44,6 +48,7 @@
 		this.byteBuffer = GLAllocation.createDirectByteBuffer(var1 * 4);
 		this.intBuffer = this.byteBuffer.asIntBuffer();
 		this.floatBuffer = this.byteBuffer.asFloatBuffer();
+		this.field_35836_g = this.byteBuffer.asShortBuffer();
 		this.rawBuffer = new int[var1];
 		this.useVBO = tryVBO && GLContext.getCapabilities().GL_ARB_vertex_buffer_object;
 		if(this.useVBO) {
@@ -80,6 +85,19 @@
 					GL11.glEnableClientState(GL11.GL_TEXTURE_COORD_ARRAY);
 				}
 
+				if(this.field_35838_p) {
+					OpenGlHelper.setClientActiveTexture(OpenGlHelper.lightmapEnabled);
+					if(this.useVBO) {
+						GL11.glTexCoordPointer(2, GL11.GL_SHORT, 32, 24L);
+					} else {
+						this.field_35836_g.position(14);
+						GL11.glTexCoordPointer(2, 32, (ShortBuffer)this.field_35836_g);
+					}
+
+					GL11.glEnableClientState(GL11.GL_TEXTURE_COORD_ARRAY);
+					OpenGlHelper.setClientActiveTexture(OpenGlHelper.lightmapDisabled);
+				}
+
 				if(this.hasColor) {
 					if(this.useVBO) {
 						GL11.glColorPointer(4, GL11.GL_UNSIGNED_BYTE, 32, 20L);
@@ -121,6 +139,12 @@
 					GL11.glDisableClientState(GL11.GL_TEXTURE_COORD_ARRAY);
 				}
 
+				if(this.field_35838_p) {
+					OpenGlHelper.setClientActiveTexture(OpenGlHelper.lightmapEnabled);
+					GL11.glDisableClientState(GL11.GL_TEXTURE_COORD_ARRAY);
+					OpenGlHelper.setClientActiveTexture(OpenGlHelper.lightmapDisabled);
+				}
+
 				if(this.hasColor) {
 					GL11.glDisableClientState(GL11.GL_COLOR_ARRAY);
 				}
@@ -155,6 +179,7 @@
 			this.hasNormals = false;
 			this.hasColor = false;
 			this.hasTexture = false;
+			this.field_35838_p = false;
 			this.isColorDisabled = false;
 		}
 	}
@@ -165,6 +190,11 @@
 		this.textureV = var3;
 	}
 
+	public void func_35835_b(int var1) {
+		this.field_35838_p = true;
+		this.field_35837_l = var1;
+	}
+
 	public void setColorOpaque_F(float var1, float var2, float var3) {
 		this.setColorOpaque((int)(var1 * 255.0F), (int)(var2 * 255.0F), (int)(var3 * 255.0F));
 	}
@@ -236,6 +266,10 @@
 					this.rawBuffer[this.rawBufferIndex + 4] = this.rawBuffer[this.rawBufferIndex - var8 + 4];
 				}
 
+				if(this.field_35838_p) {
+					this.rawBuffer[this.rawBufferIndex + 7] = this.rawBuffer[this.rawBufferIndex - var8 + 7];
+				}
+
 				if(this.hasColor) {
 					this.rawBuffer[this.rawBufferIndex + 5] = this.rawBuffer[this.rawBufferIndex - var8 + 5];
 				}
@@ -253,6 +287,10 @@
 			this.rawBuffer[this.rawBufferIndex + 4] = Float.floatToRawIntBits((float)this.textureV);
 		}
 
+		if(this.field_35838_p) {
+			this.rawBuffer[this.rawBufferIndex + 7] = this.field_35837_l;
+		}
+
 		if(this.hasColor) {
 			this.rawBuffer[this.rawBufferIndex + 5] = this.color;
 		}
@@ -297,7 +335,7 @@
 		}
 
 		this.hasNormals = true;
-		byte var4 = (byte)((int)(var1 * 128.0F));
+		byte var4 = (byte)((int)(var1 * 127.0F));
 		byte var5 = (byte)((int)(var2 * 127.0F));
 		byte var6 = (byte)((int)(var3 * 127.0F));
 		this.normal = var4 | var5 << 8 | var6 << 16;
--- net/minecraft/src/ItemRenderer.java
+++ net/minecraft/src/ItemRenderer.java
@@ -22,7 +22,7 @@
 		GL11.glPushMatrix();
 		if(var2.itemID < 256 && RenderBlocks.renderItemIn3d(Block.blocksList[var2.itemID].getRenderType())) {
 			GL11.glBindTexture(GL11.GL_TEXTURE_2D, this.mc.renderEngine.getTexture("/terrain.png"));
-			this.renderBlocksInstance.renderBlockOnInventory(Block.blocksList[var2.itemID], var2.getItemDamage(), var1.getEntityBrightness(1.0F));
+			this.renderBlocksInstance.renderBlockOnInventory(Block.blocksList[var2.itemID], var2.getItemDamage(), 1.0F);
 		} else {
 			if(var2.itemID < 256) {
 				GL11.glBindTexture(GL11.GL_TEXTURE_2D, this.mc.renderEngine.getTexture("/terrain.png"));
@@ -136,8 +136,15 @@
 		GL11.glRotatef(var3.prevRotationYaw + (var3.rotationYaw - var3.prevRotationYaw) * var1, 0.0F, 1.0F, 0.0F);
 		RenderHelper.enableStandardItemLighting();
 		GL11.glPopMatrix();
+		float var6;
 		ItemStack var5 = this.itemToRender;
-		float var6 = this.mc.theWorld.getLightBrightness(MathHelper.floor_double(var3.posX), MathHelper.floor_double(var3.posY), MathHelper.floor_double(var3.posZ));
+		var6 = this.mc.theWorld.getLightBrightness(MathHelper.floor_double(var3.posX), MathHelper.floor_double(var3.posY), MathHelper.floor_double(var3.posZ));
+		var6 = 1.0F;
+		int var70 = this.mc.theWorld.func_35451_b(MathHelper.floor_double(var3.posX), MathHelper.floor_double(var3.posY), MathHelper.floor_double(var3.posZ), 0);
+		int var71 = var70 % 65536;
+		int var72 = var70 / 65536;
+		OpenGlHelper.setLightmapTextureCoords(OpenGlHelper.lightmapEnabled, (float)var71 / 1.0F, (float)var72 / 1.0F);
+		GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
 		float var8;
 		float var9;
 		float var10;
--- net/minecraft/src/RenderSpider.java
+++ net/minecraft/src/RenderSpider.java
@@ -22,7 +22,12 @@
 			float var4 = (1.0F - var1.getEntityBrightness(1.0F)) * 0.5F;
 			GL11.glEnable(GL11.GL_BLEND);
 			GL11.glDisable(GL11.GL_ALPHA_TEST);
-			GL11.glBlendFunc(GL11.GL_SRC_ALPHA, GL11.GL_ONE_MINUS_SRC_ALPHA);
+			GL11.glBlendFunc(GL11.GL_ONE, GL11.GL_ONE);
+			char var5 = '\uf0f0';
+			int var6 = var5 % 65536;
+			int var7 = var5 / 65536;
+			OpenGlHelper.setLightmapTextureCoords(OpenGlHelper.lightmapEnabled, (float)var6 / 1.0F, (float)var7 / 1.0F);
+			GL11.glColor4f(1.0F, 1.0F, 1.0F, 1.0F);
 			GL11.glColor4f(1.0F, 1.0F, 1.0F, var4);
 			return true;
 		}
--- net/minecraft/src/RenderItem.java
+++ net/minecraft/src/RenderItem.java
@@ -57,7 +57,8 @@
 					GL11.glTranslatef(var16, var17, var18);
 				}
 
-				this.renderBlocks.renderBlockOnInventory(Block.blocksList[var10.itemID], var10.getItemDamage(), var1.getEntityBrightness(var9));
+				var16 = 1.0F;
+				this.renderBlocks.renderBlockOnInventory(Block.blocksList[var10.itemID], var10.getItemDamage(), var16);
 				GL11.glPopMatrix();
 			}
 		} else {
@@ -86,7 +87,7 @@
 				var24 = (float)(var23 >> 16 & 255) / 255.0F;
 				var25 = (float)(var23 >> 8 & 255) / 255.0F;
 				var26 = (float)(var23 & 255) / 255.0F;
-				float var27 = var1.getEntityBrightness(var9);
+				float var27 = 1.0F;
 				GL11.glColor4f(var24 * var27, var25 * var27, var26 * var27, 1.0F);
 			}
 
--- net/minecraft/src/GuiStats.java
+++ net/minecraft/src/GuiStats.java
@@ -78,10 +78,7 @@
 	private void func_27138_c(int var1, int var2, int var3) {
 		this.func_27147_a(var1 + 1, var2 + 1);
 		GL11.glEnable(GL12.GL_RESCALE_NORMAL);
-		GL11.glPushMatrix();
-		GL11.glRotatef(180.0F, 1.0F, 0.0F, 0.0F);
-		RenderHelper.enableStandardItemLighting();
-		GL11.glPopMatrix();
+		RenderHelper.func_41089_c();
 		field_27153_j.drawItemIntoGui(this.fontRenderer, this.mc.renderEngine, var3, 0, Item.itemsList[var3].getIconFromDamage(0), var1 + 2, var2 + 2);
 		RenderHelper.disableStandardItemLighting();
 		GL11.glDisable(GL12.GL_RESCALE_NORMAL);
--- net/minecraft/src/EntitySlimeFX.java
+++ net/minecraft/src/EntitySlimeFX.java
@@ -22,7 +22,7 @@
 		float var13 = (float)(this.prevPosX + (this.posX - this.prevPosX) * (double)var2 - interpPosX);
 		float var14 = (float)(this.prevPosY + (this.posY - this.prevPosY) * (double)var2 - interpPosY);
 		float var15 = (float)(this.prevPosZ + (this.posZ - this.prevPosZ) * (double)var2 - interpPosZ);
-		float var16 = this.getEntityBrightness(var2);
+		float var16 = 1.0F;
 		var1.setColorOpaque_F(var16 * this.particleRed, var16 * this.particleGreen, var16 * this.particleBlue);
 		var1.addVertexWithUV((double)(var13 - var3 * var12 - var6 * var12), (double)(var14 - var4 * var12), (double)(var15 - var5 * var12 - var7 * var12), (double)var8, (double)var11);
 		var1.addVertexWithUV((double)(var13 - var3 * var12 + var6 * var12), (double)(var14 + var4 * var12), (double)(var15 - var5 * var12 + var7 * var12), (double)var8, (double)var10);
